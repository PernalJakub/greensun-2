<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- UWAGA DEV: Zaktualizuj SEO title i meta z aktualnym profilem -->
  <title>GreenSun. - Profesjonalny montaż farm fotowoltaicznych</title>
  <meta name="description" content="GreenSun - specjalizujemy się w montażu farm fotowoltaicznych na lądzie i wodzie. Ponad 1000 MW zrealizowanych projektów w Europie.">
  <meta name="keywords" content="fotowoltaika, farmy PV, montaż paneli słonecznych, energia słoneczna, wodne farmy fotowoltaiczne">
  <meta name="theme-color" content="#f2f2f2" id="theme-color-meta">
  <meta name="msapplication-navbutton-color" content="#f2f2f2" id="ms-nav-color">
  <meta name="apple-mobile-web-app-status-bar-style" content="default" id="apple-status-bar">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="./media/website-icon.svg">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- CSS Variables -->
  <link rel="stylesheet" href="./css/variables.css">

  <!-- Base Styles -->
  <link rel="stylesheet" href="./css/base.css">

  <!-- Component Styles -->
  <link rel="stylesheet" href="./css/components.css">

  <!-- i18n Module -->
  <script src="./js/i18n.js"></script>

  <!-- Google Analytics 4 - PLACEHOLDER -->
  <!-- Tutaj wklej swój kod Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'GA_MEASUREMENT_ID'); // Zamień na prawdziwy ID
  </script>
  
  <!-- Internationalization Script -->
  <script>
    // Helper function to update all meta tags for mobile browsers
    function updateMobileMetaTags(theme) {
      const color = theme === 'dark' ? '#1a1a1b' : '#f2f2f2';
      
      // Theme color for Chrome Mobile
      const themeColorMeta = document.getElementById('theme-color-meta');
      if (themeColorMeta) {
        themeColorMeta.setAttribute('content', color);
      }
      
      // MS Application nav button color
      const msNavColor = document.getElementById('ms-nav-color');
      if (msNavColor) {
        msNavColor.setAttribute('content', color);
      }
      
      // Apple status bar style
      const appleStatusBar = document.getElementById('apple-status-bar');
      if (appleStatusBar) {
        appleStatusBar.setAttribute('content', theme === 'dark' ? 'black-translucent' : 'default');
      }
    }

    // Translations loaded from external JSON files via i18n module
    let translations = {};
    let formMessages = {};
    let translationsReady = false;

    // Promise that resolves when translations are loaded
    const translationsLoadedPromise = (async function initTranslations() {
      try {
        // Load all languages
        await window.i18n.loadAllLanguages();

        // Populate translations object from i18n module
        translations = {
          pl: window.i18n.translations.pl || {},
          en: window.i18n.translations.en || {},
          fr: window.i18n.translations.fr || {}
        };

        // Extract form messages from translations
        formMessages = {
          pl: {
            sending: translations.pl['form-sending'] || 'Wysyłanie...',
            sent: translations.pl['form-sent'] || 'Wysłano!',
            error: translations.pl['form-error'] || 'Błąd',
            serverError: translations.pl['form-serverError'] || 'Błąd serwera',
            genericError: translations.pl['form-genericError'] || 'Wystąpił błąd',
            successFallback: translations.pl['form-successFallback'] || 'Wysłano pomyślnie!',
            valueMissing: translations.pl['form-valueMissing'] || 'Wypełnij to pole.',
            typeMismatch: translations.pl['form-typeMismatch'] || 'Wprowadź prawidłowy email.',
            tooShort: translations.pl['form-tooShort'] || 'Pole za krótkie.',
            checkboxRequired: translations.pl['form-checkboxRequired'] || 'Zaznacz to pole.'
          },
          en: {
            sending: translations.en['form-sending'] || 'Sending...',
            sent: translations.en['form-sent'] || 'Sent!',
            error: translations.en['form-error'] || 'Error',
            serverError: translations.en['form-serverError'] || 'Server error',
            genericError: translations.en['form-genericError'] || 'An error occurred',
            successFallback: translations.en['form-successFallback'] || 'Sent successfully!',
            valueMissing: translations.en['form-valueMissing'] || 'Please fill out this field.',
            typeMismatch: translations.en['form-typeMismatch'] || 'Please enter a valid email.',
            tooShort: translations.en['form-tooShort'] || 'Please lengthen this text.',
            checkboxRequired: translations.en['form-checkboxRequired'] || 'Please check this box.'
          },
          fr: {
            sending: translations.fr['form-sending'] || 'Envoi...',
            sent: translations.fr['form-sent'] || 'Envoyé !',
            error: translations.fr['form-error'] || 'Erreur',
            serverError: translations.fr['form-serverError'] || 'Erreur serveur',
            genericError: translations.fr['form-genericError'] || 'Une erreur s\'est produite',
            successFallback: translations.fr['form-successFallback'] || 'Envoyé avec succès !',
            valueMissing: translations.fr['form-valueMissing'] || 'Veuillez remplir ce champ.',
            typeMismatch: translations.fr['form-typeMismatch'] || 'Veuillez saisir un email valide.',
            tooShort: translations.fr['form-tooShort'] || 'Veuillez allonger ce texte.',
            checkboxRequired: translations.fr['form-checkboxRequired'] || 'Veuillez cocher cette case.'
          }
        };

        translationsReady = true;

        // Initialize the page after translations are loaded
        detectUserLanguage();

        return true;
      } catch (error) {
        console.error('Failed to load translations:', error);
        // Fallback to empty objects - user will see translation keys
        translations = { pl: {}, en: {}, fr: {} };
        formMessages = { pl: {}, en: {}, fr: {} };
        translationsReady = true;
        return false;
      }
    })();


    let currentLanguage = 'pl';

    // DEPRECATED: Form messages now loaded from external JSON files via i18n module (see above)

    async function detectUserLanguage() {
      // Check if user has a saved language preference
      const savedLang = localStorage.getItem('preferred-language');
      if (savedLang && ['pl', 'en', 'fr'].includes(savedLang)) {
        await setLanguage(savedLang);
        return;
      }

      // Otherwise, detect from browser language
      const browserLang = navigator.language.split('-')[0];
      if (browserLang === 'pl') {
        await setLanguage('pl');
      } else if (browserLang === 'fr') {
        await setLanguage('fr');
      } else {
        await setLanguage('en');
      }
    }

    async function setLanguage(lang) {
      // Wait for translations to be loaded
      await translationsLoadedPromise;

      currentLanguage = lang;
      document.documentElement.lang = lang;
      updateContent();
      localStorage.setItem('preferred-language', lang);

      // Update carousel captions if carousel is initialized
      if (typeof window.updateCarouselLanguage === 'function') {
        window.updateCarouselLanguage();
      }

      // Update language switcher display
      const currentLangButtons = document.querySelectorAll('.current-lang');
      currentLangButtons.forEach(button => {
        const flag = button.querySelector('.flag');
        if (flag) {
          flag.className = `flag ${lang}`;
        }
        const text = button.querySelector('.lang-text');
        if (text) {
          text.textContent = lang.toUpperCase();
        }
      });

      // Update subject dropdown placeholder if no selection is made
      const subjectText = document.querySelector('.subject-text');
      const hiddenSubjectInput = document.getElementById('subject');
      if (subjectText && hiddenSubjectInput && !hiddenSubjectInput.value) {
        subjectText.textContent = translations[currentLanguage]['subject-placeholder'];
      }

      // Update HTML5 validation messages
      updateFormValidation(lang);
    }

    function updateFormValidation(lang) {
      const form = document.getElementById('contactForm');
      if (!form) return;

      const messages = formMessages[lang];

      // Get all required fields
      const requiredInputs = form.querySelectorAll('input[required], textarea[required]');
      requiredInputs.forEach(input => {
        input.addEventListener('invalid', function() {
          if (this.validity.valueMissing) {
            this.setCustomValidity(messages.valueMissing);
          } else if (this.validity.typeMismatch) {
            this.setCustomValidity(messages.typeMismatch);
          } else if (this.validity.tooShort) {
            this.setCustomValidity(messages.tooShort);
          }
        });

        // Reset custom validity on input
        input.addEventListener('input', function() {
          this.setCustomValidity('');
        });
      });

      // Handle checkbox separately
      const privacyCheckbox = form.querySelector('input[name="privacy"]');
      if (privacyCheckbox) {
        privacyCheckbox.addEventListener('invalid', function() {
          this.setCustomValidity(messages.checkboxRequired);
        });

        privacyCheckbox.addEventListener('change', function() {
          this.setCustomValidity('');
        });
      }
    }

    function updateContent() {
      const elements = document.querySelectorAll('[data-i18n]');
      elements.forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[currentLanguage] && translations[currentLanguage][key]) {
          // Handle placeholder attributes
          if (key.includes('placeholder') || element.hasAttribute('placeholder')) {
            element.placeholder = translations[currentLanguage][key];
          }
          // Handle input/textarea elements without placeholder
          else if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            element.placeholder = translations[currentLanguage][key];
          }
          // Handle title attributes
          else if (element.hasAttribute('title')) {
            element.title = translations[currentLanguage][key];
          }
          // Handle text content
          else {
            // Check if the translation contains HTML
            if (translations[currentLanguage][key].includes('<')) {
              element.innerHTML = translations[currentLanguage][key];
            } else {
              element.textContent = translations[currentLanguage][key];
            }
          }
        }
      });

      document.title = translations[currentLanguage]['site-title'];
      const descMeta = document.querySelector('meta[name="description"]');
      const keywordsMeta = document.querySelector('meta[name="keywords"]');
      
      if (descMeta) descMeta.content = translations[currentLanguage]['site-description'];
      if (keywordsMeta) keywordsMeta.content = translations[currentLanguage]['site-keywords'];
    }

    function initializeLanguage() {
      // Language is initialized in initTranslations() after translations are loaded
      // This function is kept for compatibility but does nothing
      // Translation detection happens automatically in initTranslations
    }

    function setupLanguageSwitcher() {
      const languageSwitchers = document.querySelectorAll('.language-switcher, .mobile-language-switcher');
      
      languageSwitchers.forEach(switcher => {
        const currentLangButton = switcher.querySelector('.current-lang');
        const dropdown = switcher.querySelector('.dropdown');
        const languageButtons = dropdown.querySelectorAll('button');
        
        currentLangButton.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          dropdown.classList.toggle('show');
        });
        
        languageButtons.forEach(button => {
          button.addEventListener('click', async (e) => {
            e.preventDefault();
            const lang = button.getAttribute('data-lang');
            await setLanguage(lang);
            dropdown.classList.remove('show');
          });
        });
      });
      
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.language-switcher') && !e.target.closest('.mobile-language-switcher')) {
          document.querySelectorAll('.dropdown').forEach(dropdown => {
            dropdown.classList.remove('show');
          });
        }
      });
    }

    // Theme Toggle Functionality
    function initializeTheme() {
      // Check for saved theme preference with expiration (1 hour)
      const savedTheme = localStorage.getItem('theme');
      const themeTimestamp = localStorage.getItem('themeTimestamp');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

      let theme;

      // Check if saved theme has expired (1 hour = 3600000ms)
      const oneHour = 3600000;
      const isExpired = themeTimestamp && (Date.now() - parseInt(themeTimestamp)) > oneHour;

      if (savedTheme && !isExpired) {
        // Use saved theme if not expired
        theme = savedTheme;
      } else {
        // Auto-detect based on system preference (expired or no saved theme)
        theme = prefersDark ? 'dark' : 'light';
        localStorage.setItem('theme', theme);
        localStorage.setItem('themeTimestamp', Date.now().toString());
      }

      // Apply theme
      document.documentElement.setAttribute('data-theme', theme);

      // Update mobile meta tags
      updateMobileMetaTags(theme);

      // Ensure body has the proper background color immediately
      document.body.style.backgroundColor = theme === 'dark' ? '#1a1a1b' : '#f2f2f2';
    }

    function setupThemeToggle() {
      const themeToggleButtons = document.querySelectorAll('.theme-toggle');

      themeToggleButtons.forEach(button => {
        button.addEventListener('click', function() {
          const currentTheme = document.documentElement.getAttribute('data-theme');
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

          // Apply new theme
          document.documentElement.setAttribute('data-theme', newTheme);

          // Update mobile meta tags
          updateMobileMetaTags(newTheme);

          // Save preference with timestamp
          localStorage.setItem('theme', newTheme);
          localStorage.setItem('themeTimestamp', Date.now().toString());

          // Add smooth transition for the switch
          button.style.transform = 'scale(0.95)';
          setTimeout(() => {
            button.style.transform = 'scale(1)';
          }, 150);
        });
      });
    }

    // Listen for system theme changes
    function setupThemeWatcher() {
      const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');

      mediaQuery.addEventListener('change', function(e) {
        // Only auto-switch if no manual preference is set or if it expired
        const savedTheme = localStorage.getItem('theme');
        const themeTimestamp = localStorage.getItem('themeTimestamp');
        const oneHour = 3600000;
        const isExpired = themeTimestamp && (Date.now() - parseInt(themeTimestamp)) > oneHour;

        if (!savedTheme || isExpired) {
          const newTheme = e.matches ? 'dark' : 'light';
          document.documentElement.setAttribute('data-theme', newTheme);

          // Update mobile meta tags
          updateMobileMetaTags(newTheme);

          localStorage.setItem('theme', newTheme);
          localStorage.setItem('themeTimestamp', Date.now().toString());
        }
      });
    }

    // Initialize theme immediately to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('theme');
      const themeTimestamp = localStorage.getItem('themeTimestamp');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

      // Check if saved theme has expired (1 hour)
      const oneHour = 3600000;
      const isExpired = themeTimestamp && (Date.now() - parseInt(themeTimestamp)) > oneHour;

      let theme;
      if (savedTheme && !isExpired) {
        theme = savedTheme;
      } else {
        theme = prefersDark ? 'dark' : 'light';
        localStorage.setItem('theme', theme);
        localStorage.setItem('themeTimestamp', Date.now().toString());
      }

      document.documentElement.setAttribute('data-theme', theme);

      // Update mobile meta tags immediately
      updateMobileMetaTags(theme);
    })();

    document.addEventListener('DOMContentLoaded', function() {
      initializeLanguage();
      setupLanguageSwitcher();
      initializeTheme();
      setupThemeToggle();
      setupThemeWatcher();
    });
  </script>

  <!-- Meta Pixel - PLACEHOLDER -->
  <script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', 'YOUR_PIXEL_ID'); // Zamień na prawdziwy Pixel ID
  fbq('track', 'PageView');
  </script>
  <noscript>
    <img height="1" width="1" style="display:none" 
         src="https://www.facebook.com/tr?id=YOUR_PIXEL_ID&ev=PageView&noscript=1"/>
  </noscript>
</head>
<body>

  <!-- ===== SVG GRADIENT DEFINITIONS ===== -->
  <svg width="0" height="0" style="position: absolute;">
    <defs>
      <linearGradient id="gs-grad" x1="0%" y1="100%" x2="100%" y2="0%">
        <stop offset="60%" style="stop-color:#1fc55c;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#2de3b9;stop-opacity:1" />
      </linearGradient>
    </defs>
  </svg>

  <section class="navbar-section">
    <div class="navbar-container hide-navbar start-show-navbar">
      <div class="navbar-inner">
      <div class="navbar-left delay-0">
        <div class="navbar-logo"></div>
      </div> 
      <div class="navbar-center">
        <button class="nav-link" data-section="about-section" data-i18n="nav-about">O nas</button>
        <button class="nav-link" data-section="services-section" data-i18n="nav-services">Usługi</button>
        <button class="nav-link" data-section="gallery-section" data-i18n="nav-gallery">Realizacje</button>
        <button class="nav-link" data-section="contact-section" data-i18n="nav-contact">Kontakt</button>
      </div>
      <div class="mobile-nav-controls">
        <div class="mobile-language-switcher">
          <button class="current-lang">
            <div class="flag pl"></div>
            <span class="lang-text">PL</span>
          </button>
          <div class="dropdown">
            <button data-lang="pl">
              <div class="flag pl"></div>
              <span>Polski</span>
            </button>
            <button data-lang="en">
              <div class="flag en"></div>
              <span>English</span>
            </button>
            <button data-lang="fr">
              <div class="flag fr"></div>
              <span>Français</span>
            </button>
          </div>
        </div>
        <!-- Mobile Theme Toggle -->
        <button class="theme-toggle theme-toggle-mobile" aria-label="Toggle theme">
          <div class="theme-toggle-track">
            <div class="theme-toggle-thumb">
              <svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="5"/>
                <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
              </svg>
              <svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
              </svg>
            </div>
          </div>
        </button>
        <button class="hamburger-icon" aria-label="Toggle menu"></button>
      </div>
      <div class="navbar-right">
        <div class="language-switcher">
          <button class="current-lang">
            <div class="flag pl"></div>
            <span class="lang-text">PL</span>
          </button>
          <div class="dropdown">
            <button data-lang="pl">
              <div class="flag pl"></div>
              <span>Polski</span>
            </button>
            <button data-lang="en">
              <div class="flag en"></div>
              <span>English</span>
            </button>
            <button data-lang="fr">
              <div class="flag fr"></div>
              <span>Français</span>
            </button>
          </div>
        </div>
        <!-- Theme Toggle -->
        <button class="theme-toggle" aria-label="Toggle theme">
          <div class="theme-toggle-track">
            <div class="theme-toggle-thumb">
              <svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="5"/>
                <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
              </svg>
              <svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
              </svg>
            </div>
          </div>
        </button>
        <a href="https://www.facebook.com/greensun" target="_blank" rel="noopener" class="icon-facebook"></a>
        <a href="https://www.instagram.com/greensun" target="_blank" rel="noopener" class="icon-instagram"></a>
        <a href="https://www.linkedin.com" target="_blank" rel="noopener" class="icon-linkedin"></a>
      </div>
      </div>
    </div>
    <div class="mobile-nav-overlay">
      <div class="mobile-nav-center">
        <button class="nav-link" data-section="about-section" data-i18n="nav-about">O nas</button>
        <button class="nav-link" data-section="services-section" data-i18n="nav-services">Usługi</button>
        <button class="nav-link" data-section="gallery-section" data-i18n="nav-gallery">Realizacje</button>
        <button class="nav-link" data-section="contact-section" data-i18n="nav-contact">Kontakt</button>
      </div>
      <div class="mobile-nav-right">
        <a href="https://www.facebook.com/greensun" target="_blank" rel="noopener" class="icon-facebook-mobile"></a>
        <a href="https://www.instagram.com/greensun" target="_blank" rel="noopener" class="icon-instagram-mobile"></a>
        <a href="https://www.linkedin.com" target="_blank" rel="noopener" class="icon-linkedin-mobile"></a>
      </div>
    </div>
  </section>

  <section class="hero-section slider-section">
    <div class="slider-container">
        <!-- KARTA 1 -->
        <div class="card center-cta">
          <div class="video-background">
            <video loop muted playsinline style="opacity: 0; transition: opacity 1s ease;">
              <source src="./media/GreenSun.webm" type="video/webm">
              Przeglądarka nie obsługuje formatu WebM.
            </video>
          </div>
          <div class="card-overlay"></div>
          <div class="fade-in-item center-cta fix">
            <h2 data-i18n="hero-title">Energia słoneczna dla <span class="green-simple">przyszłości.</span></h2>
            <p data-i18n="hero-subtitle">Specjalizujemy się w montażu farm fotowoltaicznych na lądzie i na wodzie. <br>Tworzymy zrównoważoną przyszłość energetyczną.</p>
            <!-- UWAGA DEV: Dodaj drugi przycisk CTA "Zobacz wizualizacje" z data-i18n="cta-secondary" -->
            <a href="#contact-section" id="a-button" data-i18n="cta-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="black" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail-plus-icon lucide-mail-plus"><path d="M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/><path d="M19 16v6"/><path d="M16 19h6"/></svg> Napisz do nas</a>
          </div>
        </div>

        <div class="animated-data fade-in-item">
          <div class="stats">
            <div class="content">
              <div class="svg-icon"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-award-icon lucide-award"><path d="m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"/><circle cx="12" cy="8" r="6"/></svg></div>
              <div class="stat">
                <div class="count-wrap">
                  <div class="count" data-target="1000">0</div>
                  <span class="unit">+</span>
                </div>
                <p data-i18n="stats-mw">MW Zrealizowana moc</p>
              </div>
            </div>
            <div class="content">
              <div class="svg-icon"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock-icon lucide-clock"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg></div>
              <div class="stat to-fix">
                <div class="count-wrap">
                  <div class="count" data-target="5">0</div>
                  <span class="unit"></span>
                </div>
                <p data-i18n="stats-years">lat Doświadczenie</p>
              </div>
            </div>
            <div class="content">
              <div class="svg-icon"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-globe-icon lucide-globe"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg></div>
              <div class="stat">
                <div class="count-wrap">
                  <div class="count" data-target="3">0</div>
                  <span class="unit"></span>
                </div>
                <p data-i18n="stats-countries">kraje FR • ENG • PL</p>
              </div>
            </div>
          </div>
        </div>

        <div class="scroll-indicator-container fade-in-item">
          <div class="scroll-indicator">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down-icon lucide-chevron-down">
              <path d="m6 9 6 6 6-6"/>
            </svg>
          </div>
        </div>

    </div>
  </section>

  <!-- ===== SEKCJA O NAS ===== -->
  <section class="about-section" id="about-section">
    <div class="about-container">
      <div class="about-content slide-in-left">
        <h2 data-i18n="about-title">Ponad 5 lat <span class="green-simple">doświadczenia</span> w energetyce słonecznej</h2>
        <p data-i18n="about-desc1">GreenSun to firma specjalizująca się w profesjonalnym montażu konstrukcji fotowoltaicznych. Nasze doświadczenie obejmuje projekty na lądzie i wodzie, a naszym największym osiągnięciem jest bycie częścią realizacji największej farmy fotowoltaicznej na wodzie w Europie Les Ilots Blandin 74,3 MWp.</p>
        <p data-i18n="about-desc2">Zajmujemy się kompleksowym doradztwem technicznym, zarządzaniem projektami oraz montażem instalacji PV. Nasze zespoły działają w Polsce, Francji i innych krajach europejskich, zapewniając najwyższą jakość wykonania.</p>
        
        <div class="about-stats">
          <div class="about-stat scale-in">
            <div class="about-stat-number">1000+</div>
            <div class="about-stat-label" data-i18n="about-stat1">MW zainstalowane</div>
          </div>
          <div class="about-stat scale-in">
            <div class="about-stat-number">50+</div>
            <div class="about-stat-label" data-i18n="about-stat2">Zrealizowanych projekty</div>
          </div>
          <div class="about-stat scale-in">
            <div class="about-stat-number">EU</div>
            <div class="about-stat-label" data-i18n="about-stat3">Krajów działania</div>
          </div>
          <div class="about-stat scale-in">
            <div class="about-stat-number">100%</div>
            <div class="about-stat-label" data-i18n="about-stat4">Zadowolenia klientów</div>
          </div>
        </div>
      </div>
      
      <div class="about-visual slide-in-right">
        <div class="about-image-grid">
          <img src="media/fotovoltaic fields.svg" alt="Fotowoltaika - pola solarne" class="about-svg-image">
        </div>
      </div>
    </div>
  </section>

  <!-- ===== SEKCJA USŁUGI ===== -->
  <section class="services-section" id="services-section">
    <div class="services-container">
      <div class="services-header fade-in-scroll">
        <h2 data-i18n="services-title">Nasze <span class="green-simple">usługi</span></h2>
        <p data-i18n="services-desc">Oferujemy kompleksowe rozwiązania w zakresie energetyki słonecznej - od projektowania po pełny montaż i serwis instalacji fotowoltaicznych.</p>
      </div>
      
      <div class="services-grid">
        <div class="service-card fade-in-scroll">
          <div class="service-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sunset">
              <path d="M12 10V2"/>
              <path d="m4.93 10.93 1.41 1.41"/>
              <path d="M2 18h2"/>
              <path d="M20 18h2"/>
              <path d="m19.07 10.93-1.41 1.41"/>
              <path d="M22 22H2"/>
              <path d="m16 6-4 4-4-4"/>
              <path d="M16 18a4 4 0 0 0-8 0"/>
            </svg>
          </div>
          <h3 data-i18n="service1-title">Farmy fotowoltaiczne na lądzie</h3>
          <p data-i18n="service1-desc">Kompleksowy montaż farm fotowoltaicznych na terenach lądowych. Projektujemy i budujemy instalacje od małych farm po duże projekty przemysłowe.</p>
          <button class="service-expand" onclick="toggleService(this)" data-i18n="learn-more">Dowiedz się więcej</button>
          <div class="service-details">
            <ul>
              <li data-i18n="service1-item1">Prefab elementów konstrukcji</li>
              <li data-i18n="service1-item2">Wiercenie i kafarowanie (dobór technologii do gruntu)</li>
              <li data-i18n="service1-item3">Montaż konstrukcji i paneli</li>
              <li data-i18n="service1-item4">Kontrola jakości & przygotowanie dokumentacji</li>
              <li data-i18n="service1-item5">HSE / BHP i standardy UE</li>
            </ul>
          </div>
        </div>

        <div class="service-card fade-in-scroll">
          <div class="service-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-waves">
              <path d="M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>
              <path d="M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>
              <path d="M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>
            </svg>
          </div>
          <h3 data-i18n="service2-title">Wodne farmy fotowoltaiczne</h3>
          <p data-i18n="service2-desc">Specjalizujemy się w montażu farm PV na wodzie - innowacyjne rozwiązanie zwiększające efektywność i oszczędzające przestrzeń lądową.</p>
          <button class="service-expand" onclick="toggleService(this)" data-i18n="learn-more">Dowiedz się więcej</button>
          <div class="service-details">
            <ul>
              <li data-i18n="service2-item1">Wodowanie (logistyka na akwenie, proces wprowadzania platform na wodę)</li>
              <li data-i18n="service2-item2">Montaż platform i konstrukcji pływającej</li>
              <li data-i18n="service2-item3">Instalacja paneli na platformach</li>
              <li data-i18n="service2-item4">Kontrola jakości & dokumentacja</li>
              <li data-i18n="service2-item5">HSE / procedury na wodzie</li>
            </ul>
          </div>
        </div>

        <div class="service-card fade-in-scroll">
          <div class="service-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-check">
              <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
              <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
              <path d="m9 15 2 2 4-4"/>
            </svg>
          </div>
          <h3 data-i18n="service3-title">Doradztwo i zarządzanie</h3>
          <p data-i18n="service3-desc">Pełne wsparcie od koncepcji do uruchomienia - zapewniamy kompleksowe doradztwo i profesjonalne zarządzanie projektami fotowoltaicznymi.</p>
          <button class="service-expand" onclick="toggleService(this)" data-i18n="learn-more">Dowiedz się więcej</button>
          <div class="service-details">
            <ul>
              <li data-i18n="service3-item1">Harmonogram i koordynacja ekip/podwykonawców (FR/EN/PL)</li>
              <li data-i18n="service3-item2">Nadzór postępu, raportowanie, ryzyka, QA/QC</li>
              <li data-i18n="service3-item3">Współpraca z dostawcami i inspektorami</li>
              <li data-i18n="service3-item4">Organizacja odbiorów i kompletacja dokumentacji powykonawczej</li>
              <li data-i18n="service3-item5">Porozmawiajmy o zakresie</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== WIZUALIZACJE ===== -->
  <section class="gallery-section" id="gallery-section">
    <div class="gallery-container">
      <div class="gallery-header fade-in-scroll">
        <h2 data-i18n="gallery-title">Nasze <span class="green-simple">realizacje</span></h2>
        <p data-i18n="gallery-desc">Profesjonalne instalacje fotowoltaiczne w Polsce i Europie</p>
      </div>

      <!-- Carousel Container -->
      <div class="carousel-container fade-in-scroll">
        <!-- Padding tile left -->
        <div class="carousel-padding-tile"></div>
        <!-- Carousel Tiles -->
        <div class="carousel-tile" data-position="0"></div>
        <div class="carousel-tile" data-position="1"></div>
        <div class="carousel-tile active" data-position="2"></div>
        <div class="carousel-tile" data-position="3"></div>
        <div class="carousel-tile" data-position="4"></div>
        <!-- Padding tile right -->
        <div class="carousel-padding-tile"></div>
      </div>

      <!-- Dots Navigation -->
      <div class="carousel-dots fade-in-scroll"></div>
    </div>
  </section>

  <!-- ===== DLACZEGO MY ===== -->
  <section class="why-us-section">
    <div class="why-us-container">
      <div class="why-us-header fade-in-scroll">
        <h2 data-i18n="why-us-title">Dlaczego <span class="green-simple">my</span></h2>
        <p class="why-us-intro" data-i18n="why-us-intro">Od 2020, z dużym doświadczeniem w montażach; znając typowe problemy realizacyjne, zapobiegamy im i kończymy z najlepszą jakością.</p>
      </div>

      <div class="why-us-grid">
        <div class="why-us-card fade-in-scroll">
          <div class="why-us-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dam-icon lucide-dam">
              <path d="M11 11.31c1.17.56 1.54 1.69 3.5 1.69 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>
              <path d="M11.75 18c.35.5 1.45 1 2.75 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>
              <path d="M2 10h4"/>
              <path d="M2 14h4"/>
              <path d="M2 18h4"/>
              <path d="M2 6h4"/>
              <path d="M7 3a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1L10 4a1 1 0 0 0-1-1z"/>
            </svg>
          </div>
          <h3 data-i18n="why-us-spec-title">Specjalizacja: grunt + woda</h3>
          <p data-i18n="why-us-spec-desc">Kafarowanie i wiercenie, pre-assembly, montaż konstrukcji i paneli. Na wodzie: wodowanie i łączenie wysp. Dedykowane brygady i sprzęt pływający.</p>
        </div>

        <div class="why-us-card fade-in-scroll">
          <div class="why-us-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield-user-icon lucide-shield-user">
              <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/>
              <path d="M6.376 18.91a6 6 0 0 1 11.249.003"/>
              <circle cx="12" cy="11" r="4"/>
            </svg>
          </div>
          <h3 data-i18n="why-us-exp-title">Doświadczenie w prowadzeniu projektów</h3>
          <p data-i18n="why-us-exp-desc">Jesteśmy nową spółką, ale nasz zespół od 2020 r. prowadził, montował i domykał projekty PV we Francji, Irlandii i Polsce — z naciskiem na jakość. 1000+ MW w zarządzaniu i montażu. Uczestniczyliśmy w realizacji największej farmy wodnej w Europie.</p>
        </div>

        <div class="why-us-card fade-in-scroll">
          <div class="why-us-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hard-hat-icon lucide-hard-hat">
              <path d="M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5"/>
              <path d="M14 6a6 6 0 0 1 6 6v3"/>
              <path d="M4 15v-3a6 6 0 0 1 6-6"/>
              <rect x="2" y="15" width="20" height="4" rx="1"/>
            </svg>
          </div>
          <h3 data-i18n="why-us-standards-title">Standardy HSE/QA i dokumentacja</h3>
          <p data-i18n="why-us-standards-desc">PPSPS, audyty HSE. Kontrola jakości i momentów dokręceń (rejestry torque), karty kontroli. Raporty dzienne/tygodniowe i komplet dokumentacji pomontażowej.</p>
        </div>

        <div class="why-us-card fade-in-scroll">
          <div class="why-us-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-languages-icon lucide-languages">
              <path d="m5 8 6 6"/>
              <path d="m4 14 6-6 2-3"/>
              <path d="M2 5h12"/>
              <path d="M7 2h1"/>
              <path d="m22 22-5-10-5 10"/>
              <path d="M14 18h6"/>
            </svg>
          </div>
          <h3 data-i18n="why-us-comm-title">Komunikacja FR/EN/PL</h3>
          <p data-i18n="why-us-comm-desc">Bezpośredni kontakt z PM, status tygodniowy + szybkie decyzje. Dokumenty i raporty w FR/EN/PL zgodnie z wymaganiami klienta. Jasne SLA i jeden punkt odpowiedzialności.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== FORMULARZ KONTAKTOWY ===== -->
  <section class="contact-section" id="contact-section">
    <div class="contact-container">
      <div class="contact-header fade-in-scroll">
        <h2 data-i18n="contact-title">Skontaktuj się z <span class="green-simple">nami</span></h2>
        <p data-i18n="contact-desc">Masz pytania dotyczące naszych usług? Chcesz otrzymać wycenę dla swojego projektu? Napisz do nas!</p>
      </div>
      
      <!-- Formularz obsługiwany przez JavaScript -->
      <form class="contact-form fade-in-scroll" id="contactForm" onsubmit="return false;" method="POST">
        <!-- Honeypot field - ukryte dla użytkowników, widoczne dla botów -->
        <div class="honeypot" style="position: absolute; left: -9999px; opacity: 0; pointer-events: none;">
          <label for="website">Website (leave blank)</label>
          <input type="text" id="website" name="website" tabindex="-1" autocomplete="off">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="firstName" data-i18n="form-firstname">Imię *</label>
            <input type="text" id="firstName" name="firstName" required>
          </div>
          <div class="form-group">
            <label for="company" data-i18n="form-company">Firma</label>
            <input type="text" id="company" name="company">
          </div>
        </div>
        
        <div class="form-group">
          <label for="email" data-i18n="form-email">Adres email *</label>
          <input type="email" id="email" name="email" required>
        </div>
        
        <div class="form-group">
          <label for="subject" data-i18n="form-subject">Temat</label>
          <div class="subject-switcher">
            <button type="button" class="current-subject">
              <span class="subject-text" data-i18n="subject-placeholder">Wybierz temat</span>
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <div class="subject-dropdown">
              <button type="button" data-value="mounting-ground">
                <span data-i18n="subject-mounting-ground">Montaż konstrukcji - grunt</span>
              </button>
              <button type="button" data-value="mounting-water">
                <span data-i18n="subject-mounting-water">Montaż konstrukcji - woda</span>
              </button>
              <button type="button" data-value="pm-cm-support">
                <span data-i18n="subject-pm-cm-support">Wsparcie PM/CM</span>
              </button>
              <button type="button" data-value="quote">
                <span data-i18n="subject-quote">Wycena projektu</span>
              </button>
              <button type="button" data-value="other">
                <span data-i18n="subject-other">Inne</span>
              </button>
            </div>
          </div>
          <input type="hidden" id="subject" name="subject">
        </div>
        
        <div class="form-group">
          <label for="message" data-i18n="form-message">Wiadomość *</label>
          <textarea id="message" name="message" required data-i18n="form-message-placeholder" placeholder="Opisz swój projekt lub zadaj pytanie..."></textarea>
        </div>
        
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="privacy" name="privacy" required>
            <label for="privacy" data-i18n="form-privacy">Wyrażam zgodę na przetwarzanie moich danych osobowych zgodnie z RODO (obowiązkowe) *</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="marketing" name="marketing">
            <label for="marketing" data-i18n="form-marketing">Wyrażam zgodę na otrzymywanie informacji marketingowych</label>
          </div>
        </div>
        
        <button type="submit" class="submit-btn" data-i18n="form-submit">Wyślij wiadomość</button>
        
        <!-- Status wiadomości -->
        <div class="form-status" id="formStatus" style="display: none;">
          <div class="status-success" id="statusSuccess">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" fill="#22c55e"/>
              <path d="M9 12L11 14L15 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span data-i18n="msg-success">Wiadomość została wysłana pomyślnie!</span>
          </div>
          <div class="status-error" id="statusError">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" fill="#ef4444"/>
              <path d="M15 9L9 15M9 9L15 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span data-i18n="msg-error">Wystąpił błąd podczas wysyłania wiadomości.</span>
          </div>
        </div>
      </form>
    </div>
  </section>

  <!-- ===== STOPKA ===== -->
  <footer class="footer-section" id="footer-section">
    <div class="footer-container">
      <div class="footer-content">
        <div class="footer-brand">
          <div class="footer-brand-header">
            <div class="footer-brand-logo"></div>
          </div>
          <p data-i18n="footer-description">Profesjonalny montaż farm fotowoltaicznych na lądzie i wodzie. Tworzymy zrównoważoną przyszłość energetyczną w całej Europie.</p>
          <div class="footer-social">
            <!-- Ikony social media będą załadowane przez JS -->
            <a href="https://www.facebook.com" target="_blank" class="icon-facebook-footer"></a>
            <a href="https://www.instagram.com" target="_blank" class="icon-instagram-footer"></a>
            <a href="https://www.linkedin.com" target="_blank" class="icon-linkedin-footer"></a>
          </div>
        </div>
        
        <div class="footer-column">
          <h4 data-i18n="footer-services">Usługi</h4>
          <ul>
            <li><a href="#services-section" data-i18n="footer-land-farms">Farmy lądowe</a></li>
            <li><a href="#services-section" data-i18n="footer-water-farms">Farmy wodne</a></li>
            <li><a href="#services-section" data-i18n="footer-consulting">Doradztwo</a></li>
            <li><a href="#gallery-section" data-i18n="footer-projects">Realizacje</a></li>
          </ul>
        </div>
        
        <div class="footer-column">
          <h4 data-i18n="footer-company">Firma</h4>
          <ul>
            <li><a href="#about-section" data-i18n="footer-about">O nas</a></li>
            <li><a href="#gallery-section" data-i18n="footer-portfolio">Portfolio</a></li>
            <li><a href="/careers" data-i18n="footer-careers">Kariera</a></li>
            <li><a href="/blog" data-i18n="footer-blog">Blog</a></li>
          </ul>
        </div>
        
        <div class="footer-column">
          <h4 data-i18n="footer-contact">Kontakt</h4>
          <ul>
            <li><a href="mailto:contact@green-sun.net">contact@green-sun.net</a></li>
            <li><a href="tel:+33749784856">+33 7 49 78 48 56</a></li>
            <li><a>31 Rue des Dunes, <br>85160 Saint Jean de Monts</a></li>
            <li><a href="#contact-section" data-i18n="footer-contact-form">Formularz kontaktowy</a></li>
          </ul>
        </div>
      </div>
      
      <div class="footer-bottom">
        <div data-i18n="footer-copyright">&copy; 2026 GreenSun. Wszystkie prawa zastrzeżone.</div>
        <div>
          <a href="privacy.html" data-i18n="footer-privacy">Polityka Prywatności</a> | 
          <a href="terms.html" data-i18n="footer-terms">Regulamin</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- ===== BANER COOKIES ===== -->
  <div class="cookie-banner" id="cookieBanner">
    <div class="cookie-content">
      <div class="cookie-text">
        <span data-i18n="cookie-text">Ta strona używa plików cookies aby zapewnić najlepsze doświadczenia użytkownika.</span> 
        <a href="privacy.html" data-i18n="cookie-learn">Dowiedz się więcej</a>
      </div>
      <div class="cookie-actions">
        <button class="cookie-btn accept" onclick="acceptCookies()" data-i18n="cookie-accept">Akceptuję</button>
        <button class="cookie-btn decline" onclick="declineCookies()" data-i18n="cookie-decline">Odrzuć</button>
      </div>
    </div>
  </div>

  <script>

    function loadGlobalSVGIcons() {
  const icons = [
    { class: "icon-logo", path: "./media/icons/logo.svg" },
    { class: "icon-facebook", path: "./media/icons/facebook.svg" },
    { class: "icon-instagram", path: "./media/icons/instagram.svg" },
    { class: "icon-linkedin", path: "./media/icons/linkedin.svg" },
    { class: "icon-tiktok", path: "./media/icons/tiktok.svg" },
    { class: "icon-booksy", path: "./media/icons/booksy.svg" },

    // Mobile versions
    { class: "icon-facebook-mobile", path: "./media/icons/facebook.svg" },
    { class: "icon-instagram-mobile", path: "./media/icons/instagram.svg" },
    { class: "icon-linkedin-mobile", path: "./media/icons/linkedin.svg" },
    { class: "icon-tiktok-mobile", path: "./media/icons/tiktok.svg" },
    { class: "icon-booksy-mobile", path: "./media/icons/booksy.svg" },

    // Footer (white version) icons
    { class: "icon-facebook-footer", path: "./media/icons/facebook.svg" },
    { class: "icon-instagram-footer", path: "./media/icons/instagram.svg" },
    { class: "icon-linkedin-footer", path: "./media/icons/linkedin.svg" },
    { class: "icon-tiktok-footer", path: "./media/icons/tiktok.svg" },
    { class: "icon-booksy-footer", path: "./media/icons/booksy.svg" },

    // Card-section (white version) icons
    { class: "icon-facebook-card", path: "./media/icons/facebook.svg" },
    { class: "icon-instagram-card", path: "./media/icons/instagram.svg" },
    { class: "icon-tiktok-card", path: "./media/icons/tiktok.svg" },
    { class: "icon-booksy-card", path: "./media/icons/booksy.svg" },

    // Button
    { class: "icon-facebook-button", path: "./media/icons/facebook.svg" },
    { class: "icon-instagram-button", path: "./media/icons/instagram.svg" },
    { class: "icon-tiktok-button", path: "./media/icons/tiktok.svg" },
    { class: "icon-booksy-button", path: "./media/icons/booksy.svg" },
    { class: "icon-button-narrowup", path: "./media/icons/narrowup.svg" },
    { class: "icon-button-narrowdown", path: "./media/icons/narrowdown.svg" },
    { class: "icon-button-linkedin", path: "./media/icons/linkedin.svg" },
    { class: "icon-button-lesson", path: "./media/icons/lesson.svg" }
  ];

  icons.forEach(icon => {
    fetch(icon.path)
      .then(response => response.text())
      .then(data => {
        const containers = document.querySelectorAll(`.${icon.class}`);
        containers.forEach(container => {
          container.innerHTML = data;
          const svg = container.querySelector('svg');
          if (svg) {
            svg.classList.add('global-icon-svg');
            svg.setAttribute('fill', 'currentColor');
            if (
              icon.class.includes("footer") ||
              icon.class.includes("card")
            ) {
              svg.classList.add('footer-icon-white');
            }
             if (
              icon.class.includes("button")
            ) {
              svg.classList.remove('global-icon-svg')
              svg.classList.add('global-icon-svg-button');
            }
          }
        });
      });
  });
}


// JS navbar-section
function initNavbarSection() {
  const root = document.querySelector(".navbar-section");
  if (!root) return;
  const links = root.querySelectorAll(".nav-link");
  function updateActiveLink() {
    const scrollPos = window.scrollY + window.innerHeight / 2;
    links.forEach(link => {
      const section = document.getElementById(link.dataset.section);
      if (section) {
        const top = section.offsetTop;
        const bottom = top + section.offsetHeight;
        if (scrollPos >= top && scrollPos < bottom) {
          link.classList.add("active");
        } else {
          link.classList.remove("active");
        }
      }
    });
  }
  window.addEventListener("scroll", updateActiveLink);
  updateActiveLink();

  // Scroll to center of section on nav-link click
  links.forEach(link => {
    link.addEventListener("click", (e) => {
      e.preventDefault();

      // Zamknij menu mobilne jeśli otwarte
      const hamburger = document.querySelector(".hamburger-icon");
      const overlay = document.querySelector(".mobile-nav-overlay");
      if (hamburger && overlay && overlay.classList.contains("active")) {
        hamburger.classList.remove("active");
        overlay.classList.add("hiding");
        document.body.classList.remove("no-scroll");
        setTimeout(() => {
          overlay.classList.remove("active");
          overlay.classList.remove("hiding");
        }, 600);
      }

      const navbar = document.querySelector(".navbar-container");
      navbar.classList.add("disable-auto-hide");
      setTimeout(() => {
        navbar.classList.remove("disable-auto-hide");
        navbar.classList.remove("hide-navbar");
      }, 1000);
      const section = document.getElementById(link.dataset.section);
      if (section) {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.offsetHeight;

        // For contact section, scroll to show the header (h2) at top
        // For other sections, center them in viewport
        let targetScroll;
        if (link.dataset.section === 'contact-section') {
          // Scroll to top of section with small offset for navbar
          const navbarHeight = 65; // Approximate navbar height
          targetScroll = sectionTop - navbarHeight + 20; // Extra 40px breathing room
        } else {
          // Center other sections
          targetScroll = sectionTop - (window.innerHeight / 2) + (sectionHeight / 2);
        }

        window.scrollTo({
          top: targetScroll,
          behavior: "smooth"
        });
      }
    });
  });
}

document.addEventListener("DOMContentLoaded", () => {
  const navbar = document.querySelector(".navbar-container");
  // Remove navbar delays - show immediately
  navbar.classList.remove("start-show-navbar");
  navbar.classList.remove("hide-navbar");


  const hamburger = document.querySelector(".hamburger-icon");
  const overlay = document.querySelector(".mobile-nav-overlay");

hamburger.addEventListener("click", () => {
  const navbarContainer = document.querySelector(".navbar-container");
  
  if (overlay.classList.contains("active")) {
    overlay.classList.add("hiding");
    hamburger.classList.remove("active");
    navbarContainer.classList.remove("menu-open");
    document.body.classList.remove("no-scroll");

    setTimeout(() => {
      overlay.classList.remove("active");
      overlay.classList.remove("hiding");
    }, 600);
  } else {
    overlay.classList.add("active");
    hamburger.classList.add("active");
    navbarContainer.classList.add("menu-open");
    document.body.classList.add("no-scroll");
  }
});

let lastScrollTop = window.scrollY;
let ticking = false;

function handleNavbarVisibility() {
  const currentScroll = window.scrollY;
  const navbar = document.querySelector(".navbar-container");

  // Dodaj białe tło po scroll w dół
  if (currentScroll > 50) {
    navbar.classList.add("scrolled");
  } else {
    navbar.classList.remove("scrolled");
  }

  // Ukryj/pokaż navbar - WYŁĄCZONE
  // if (currentScroll > lastScrollTop + 5 && currentScroll > 60) {
  //   navbar.classList.add("hide-navbar");
  // } else if (currentScroll < lastScrollTop - 5) {
  //   navbar.classList.remove("hide-navbar");
  // }

  lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
  ticking = false;
}

window.addEventListener("scroll", () => {
  if (!ticking) {
    window.requestAnimationFrame(handleNavbarVisibility);
    ticking = true;
  }
});

});

document.addEventListener("DOMContentLoaded", () => {
  initNavbarSection();

  // Logo click handler - scroll to top
  const logoElements = document.querySelectorAll('.navbar-logo');
  logoElements.forEach(logo => {
    logo.addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
  });
});
// JS navbar-section

    // JS slider-section

    document.addEventListener("DOMContentLoaded", () => {
      const rootHeroSection = document.querySelector(".hero-section");
      
      // Remove fade locks and make content immediately visible
      rootHeroSection.querySelectorAll(".fade-lock").forEach(el => el.classList.remove("fade-lock"));
      document.body.classList.add("fade-in-ready");
      
      // Show content immediately with stagger effect
      const contentElements = document.querySelectorAll(".animated-data .content");
      contentElements.forEach((el, index) => {
        setTimeout(() => {
          el.classList.add("fade-in-item");
          el.style.opacity = "1";
          el.style.transform = "translateY(0)";
        }, index * 250); // Keep stagger but start immediately
      });
      
      // Start video immediately
      const video = document.querySelector(".video-background video");
      if (video) {
        video.play();
        video.style.opacity = "1";
        const card = document.querySelector(".slider-section .card");
        if (card) {
          card.classList.add("card-shadow-visible");
          // Remove black background after 1 second
          setTimeout(() => {
            card.classList.add("fade-bg");
          }, 350);
        }
      }
    });
    
    // Liczniki animowane - start immediately when visible
    const observeCounters = () => {
      const counters = document.querySelectorAll(".count");
      const counterObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting && !entry.target.classList.contains('counted')) {
            entry.target.classList.add('counted');
            const counter = entry.target;
            const updateCount = () => {
              const target = +counter.getAttribute("data-target");
              const current = parseInt(counter.innerText) || 0;
              const increment = Math.max(1, Math.ceil(target / 100));

              if (current < target) {
                counter.innerText = current + increment;
                setTimeout(updateCount, 25);
              } else {
                counter.innerText = target;
              }
            };
            updateCount();
          }
        });
      });
      
      counters.forEach(counter => counterObserver.observe(counter));
    };
    
    document.addEventListener("DOMContentLoaded", observeCounters);

    // About Stats Counter Animation
    const observeStatCounters = () => {
      const statNumbers = document.querySelectorAll(".about-stat-number");

      const statObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting && !entry.target.classList.contains('counted')) {
            entry.target.classList.add('counted');
            const element = entry.target;
            const text = element.textContent;

            // Extract number and suffix (like +, %)
            const match = text.match(/^(\d+)(.*)$/);
            if (match) {
              const targetNumber = parseInt(match[1]);
              const suffix = match[2];

              const duration = 2000; // 2 seconds
              const frameRate = 1000 / 60; // 60 FPS
              const totalFrames = Math.round(duration / frameRate);
              let currentFrame = 0;

              const counter = setInterval(() => {
                currentFrame++;
                const progress = currentFrame / totalFrames;
                // Easing function for smooth animation
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                const currentNumber = Math.round(easeOutQuart * targetNumber);

                element.textContent = currentNumber + suffix;

                if (currentFrame >= totalFrames) {
                  element.textContent = targetNumber + suffix;
                  clearInterval(counter);
                }
              }, frameRate);
            }
          }
        });
      }, {
        threshold: 0.5,
        rootMargin: '0px'
      });

      statNumbers.forEach(stat => statObserver.observe(stat));
    };

    document.addEventListener("DOMContentLoaded", observeStatCounters);

    // JS slider-section

    // ===== ANIMACJE SCROLL =====
    function initScrollAnimations() {
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, observerOptions);

      // Obserwowanie elementów z animacjami
      document.querySelectorAll('.fade-in-scroll, .slide-in-left, .slide-in-right, .scale-in').forEach(el => {
        observer.observe(el);
      });
    }

    // ===== GALERIA SLIDER =====
    function initGalleryFilters() {
      const filterBtns = document.querySelectorAll('.filter-btn');
      const galleryGrid = document.getElementById('gallery-grid');
      const galleryItems = document.querySelectorAll('.gallery-item');
      const prevBtn = document.getElementById('gallery-prev');
      const nextBtn = document.getElementById('gallery-next');
      
      let currentSlide = 0;
      let filteredItems = [...galleryItems];
      let itemWidth = 350; // Default desktop width
      let visibleItems = 3; // Items visible at once
      
      // Calculate item width and visible items based on screen size
      function updateSliderDimensions() {
        const screenWidth = window.innerWidth;
        if (screenWidth <= 599) {
          itemWidth = 300 + 12; // item width + gap (smaller gap)
          visibleItems = 1;
        } else if (screenWidth <= 991) {
          itemWidth = 320 + 16; // item width + gap (smaller gap)
          visibleItems = 2;
        } else {
          itemWidth = 350 + 24; // item width + gap
          visibleItems = 3;
        }
      }
      
      // Update navigation buttons state
      function updateNavButtons() {
        const maxSlide = Math.max(0, filteredItems.length - visibleItems);
        prevBtn.disabled = currentSlide <= 0;
        nextBtn.disabled = currentSlide >= maxSlide;
      }
      
      // Slide to specific position
      function slideTo(position) {
        const maxSlide = Math.max(0, filteredItems.length - visibleItems);
        currentSlide = Math.max(0, Math.min(position, maxSlide));
        
        const translateX = -currentSlide * itemWidth;
        galleryGrid.style.transform = `translateX(${translateX}px)`;
        updateNavButtons();
      }
      
      // Filter items and update slider
      function filterItems(filter) {
        // Reset all items display
        galleryItems.forEach(item => {
          item.style.display = 'none';
        });
        
        // Filter items
        if (filter === 'all') {
          filteredItems = [...galleryItems];
        } else {
          filteredItems = [...galleryItems].filter(item => 
            item.dataset.category.includes(filter)
          );
        }
        
        // Show filtered items
        filteredItems.forEach(item => {
          item.style.display = 'flex';
        });
        
        // Reset slider position
        currentSlide = 0;
        slideTo(0);
      }
      
      // Navigation button events
      prevBtn.addEventListener('click', () => {
        slideTo(currentSlide - 1);
      });
      
      nextBtn.addEventListener('click', () => {
        slideTo(currentSlide + 1);
      });
      
      // Filter button events
      filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          // Update active state
          filterBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          // Filter and slide
          const filter = btn.dataset.filter;
          filterItems(filter);
        });
      });
      
      // Touch/swipe support for mobile and tablet
      let startX = 0;
      let currentX = 0;
      let isDragging = false;
      let startTranslate = 0;
      
      function getTranslateValue() {
        const transform = galleryGrid.style.transform;
        const match = transform.match(/translateX\((-?\d+(?:\.\d+)?)px\)/);
        return match ? parseFloat(match[1]) : 0;
      }
      
      galleryGrid.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
        isDragging = true;
        startTranslate = getTranslateValue();
        galleryGrid.style.transition = 'none';
      });
      
      galleryGrid.addEventListener('touchmove', (e) => {
        if (!isDragging) return;
        
        currentX = e.touches[0].clientX;
        const diffX = currentX - startX;
        const newTranslate = startTranslate + diffX;
        
        galleryGrid.style.transform = `translateX(${newTranslate}px)`;
      });
      
      galleryGrid.addEventListener('touchend', () => {
        if (!isDragging) return;
        
        isDragging = false;
        galleryGrid.style.transition = 'transform 0.4s ease';
        
        const diffX = currentX - startX;
        const threshold = itemWidth * 0.3; // 30% of item width to trigger slide
        
        if (Math.abs(diffX) > threshold) {
          if (diffX > 0) {
            // Swipe right - go to previous
            slideTo(currentSlide - 1);
          } else {
            // Swipe left - go to next
            slideTo(currentSlide + 1);
          }
        } else {
          // Snap back to current position
          slideTo(currentSlide);
        }
      });
      
      // Mouse drag support for desktop
      galleryGrid.addEventListener('mousedown', (e) => {
        startX = e.clientX;
        isDragging = true;
        startTranslate = getTranslateValue();
        galleryGrid.style.transition = 'none';
        galleryGrid.style.cursor = 'grabbing';
        e.preventDefault();
      });
      
      document.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        
        currentX = e.clientX;
        const diffX = currentX - startX;
        const newTranslate = startTranslate + diffX;
        
        galleryGrid.style.transform = `translateX(${newTranslate}px)`;
      });
      
      document.addEventListener('mouseup', () => {
        if (!isDragging) return;
        
        isDragging = false;
        galleryGrid.style.transition = 'transform 0.4s ease';
        galleryGrid.style.cursor = 'grab';
        
        const diffX = currentX - startX;
        const threshold = itemWidth * 0.3;
        
        if (Math.abs(diffX) > threshold) {
          if (diffX > 0) {
            slideTo(currentSlide - 1);
          } else {
            slideTo(currentSlide + 1);
          }
        } else {
          slideTo(currentSlide);
        }
      });
      
      // Window resize handler
      window.addEventListener('resize', () => {
        updateSliderDimensions();
        slideTo(currentSlide); // Recalculate position with new dimensions
      });
      
      // Initialize
      updateSliderDimensions();
      filterItems('all');
      galleryGrid.style.cursor = 'grab';
    }

    // ===== ROZWIJANIE USŁUG =====
    function toggleService(button) {
      const card = button.closest('.service-card');
      const details = button.nextElementSibling;
      const isExpanded = details.classList.contains('expanded');

      if (isExpanded) {
        card.classList.remove('expanded');
        details.classList.remove('expanded');
        button.setAttribute('data-i18n', 'learn-more');
        button.textContent = translations[currentLanguage]['learn-more'];
      } else {
        card.classList.add('expanded');
        details.classList.add('expanded');
        button.setAttribute('data-i18n', 'btn-collapse');
        button.textContent = translations[currentLanguage]['btn-collapse'];
      }
    }

    // ===== FORMULARZ KONTAKTOWY =====
    function initContactForm() {
      const form = document.getElementById('contactForm');
      
      // Initialize subject switcher
      const subjectSwitcher = document.querySelector('.subject-switcher');
      const currentSubjectBtn = subjectSwitcher.querySelector('.current-subject');
      const subjectDropdown = subjectSwitcher.querySelector('.subject-dropdown');
      const subjectText = subjectSwitcher.querySelector('.subject-text');
      const hiddenSubjectInput = document.getElementById('subject');
      
      // Toggle dropdown
      currentSubjectBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        subjectSwitcher.classList.toggle('active');
      });
      
      // Handle subject selection
      subjectDropdown.addEventListener('click', (e) => {
        const button = e.target.closest('button');
        if (!button) return;
        
        const value = button.getAttribute('data-value');
        const text = button.querySelector('span').textContent;
        
        // Update display text and hidden input value
        subjectText.textContent = text;
        hiddenSubjectInput.value = value;
        
        // Close dropdown
        subjectSwitcher.classList.remove('active');
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', (e) => {
        if (!subjectSwitcher.contains(e.target)) {
          subjectSwitcher.classList.remove('active');
        }
      });
      
      // Funkcja do pobierania CSRF tokenu
      async function getCsrfToken() {
        try {
          const response = await fetch('https://greensun-backend.fly.dev/csrf-token', {
            method: 'GET',
            credentials: 'include' // Ważne dla ciasteczek
          });
          if (response.ok) {
            const data = await response.json();
            return data.csrfToken;
          }
        } catch (error) {
          console.error('Błąd pobierania CSRF tokenu:', error);
        }
        return null;
      }

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;

        // Pokaż loading
        submitBtn.disabled = true;
        const lang = currentLanguage || 'pl';
        submitBtn.textContent = formMessages[lang].sending;

        try {
          // Pobierz CSRF token
          const csrfToken = await getCsrfToken();
          if (!csrfToken) {
            throw new Error(lang === 'pl' ? 'Nie można uzyskać tokenu bezpieczeństwa' :
                          lang === 'fr' ? 'Impossible d\'obtenir le jeton de sécurité' :
                          'Unable to obtain security token');
          }

          const formData = new FormData(form);
          const data = {
            firstName: formData.get('firstName') || '',
            lastName: formData.get('company') || '',
            email: formData.get('email') || '',
            subject: formData.get('subject') || 'Zapytanie ze strony',
            message: formData.get('message') || '',
            privacy: !!formData.get('privacy'),
            marketing: !!formData.get('marketing'),
            language: lang
          };

          const response = await fetch('https://greensun-backend.fly.dev/contact', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-CSRF-Token': csrfToken
            },
            credentials: 'include', // Ważne dla ciasteczek
            body: JSON.stringify(data)
          });

          if (response.ok) {
            const result = await response.json();
            // Sukces
            submitBtn.textContent = formMessages[lang].sent;
            submitBtn.style.background = 'var(--success)';
            form.reset();

            // Pokaż komunikat sukcesu z API
            showNotification(result.message || formMessages[lang].successFallback, 'success');
          } else {
            const result = await response.json();
            // Check if we have validation errors
            if (result.errors && Array.isArray(result.errors) && result.errors.length > 0) {
              // Show first error or join all errors
              throw new Error(result.errors.join('. '));
            } else {
              throw new Error(result.message || formMessages[lang].serverError);
            }
          }
        } catch (error) {
          console.error('Błąd wysyłania formularza:', error);
          submitBtn.textContent = formMessages[lang].error;
          submitBtn.style.background = 'var(--error)';
          showNotification(error.message || formMessages[lang].genericError, 'error');
        }
        
        // Przywróć przycisk po 3 sekundach
        setTimeout(() => {
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
          submitBtn.style.background = '';
        }, 3000);
      });
    }

    // ===== POWIADOMIENIA =====
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification notification-${type}`;
      notification.textContent = message;

      notification.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translate(-50%, -120%);
        padding: 16px 24px;
        border-radius: 8px;
        color: white;
        font-size: 14px;
        font-weight: 500;
        z-index: 10000;
        max-width: 90%;
        width: auto;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transition: transform 0.3s ease;
        background: ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--error)' : 'var(--primary-base)'};
      `;

      document.body.appendChild(notification);

      setTimeout(() => {
        notification.style.transform = 'translate(-50%, 0)';
      }, 100);

      setTimeout(() => {
        notification.style.transform = 'translate(-50%, -120%)';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 4000);
    }

    // ===== COOKIES BANNER =====
    function showCookieBanner() {
      const banner = document.getElementById('cookieBanner');
      const hasConsent = localStorage.getItem('cookieConsent');
      
      if (!hasConsent) {
        setTimeout(() => {
          banner.classList.add('visible');
        }, 2000);
      }
    }

    function acceptCookies() {
      localStorage.setItem('cookieConsent', 'accepted');
      document.getElementById('cookieBanner').classList.remove('visible');
      
      // Tutaj możesz włączyć dodatkowe skrypty po zgodzie
      // np. Google Analytics, Meta Pixel itp.
    }

    function declineCookies() {
      localStorage.setItem('cookieConsent', 'declined');
      document.getElementById('cookieBanner').classList.remove('visible');
    }

    
    // ===== INICJALIZACJA =====
    // Wywołanie funkcji ładowania ikon
    document.addEventListener("DOMContentLoaded", () => {
      loadGlobalSVGIcons();
      initScrollAnimations();
      initGalleryCarousel();
      initContactForm();
      showCookieBanner();
      initNavbarSection();
    });

    // ===== GALLERY CAROUSEL =====
    function initGalleryCarousel() {
      // Multilingual carousel data
      const carouselTranslations = {
          pl: [
              { t: 'Montaż od A do Z',        s: 'Prace ziemne po panele.' },
              { t: 'Farmy PV wodne',          s: 'Akweny: platformy i łączenia.' },
              { t: 'Farmy PV na gruncie',     s: 'Kafar + pre-drill; stoły i panele.' },
              { t: 'Dachy i carporty',        s: 'Także mniejsze inwestycje.' },
              { t: 'Prowadzenie projektów',   s: 'Każdy detal ma znaczenie.' }
              ],
          en: [
              { t: 'A–Z installation',        s: 'Earthworks to modules.' },
              { t: 'Floating PV farms',       s: 'Water: platforms & links.' },
              { t: 'Ground-mounted PV farms', s: 'Ground: piles, tables, modules.' },
              { t: 'Roofs & carports',        s: 'Also smaller projects.' },
              { t: 'Project delivery',        s: 'Every detail matters.' }
              ],
          fr: [
              { t: 'Montage de A à Z',        s: 'Terrassements aux modules.' },
              { t: 'Fermes PV flottantes',    s: 'Sur l’eau : plateformes & raccords.' },
              { t: 'Fermes PV terrestres',    s: 'Terre : pieux, tables, modules.' },
              { t: 'Toitures & carports',     s: 'Aussi les petits projets.' },
              { t: 'Pilotage de projets',     s: 'Chaque détail compte.' }
              ] 
      };

      const carouselImages = [
        './media/gallery/Montage de A a Z.jpg',
        './media/gallery/Fermes PV flottantes.jpeg',
        './media/gallery/Fermes PV terrestres.jpg',
        './media/gallery/Toitures & carports.jpg',
        './media/gallery/Conduite de projets professionnelle.jpg'
      ];

      // Get current language carousel data
      function getCarouselData() {
        const lang = currentLanguage || 'pl';
        const texts = carouselTranslations[lang] || carouselTranslations.pl;
        return texts.map((text, index) => ({
          src: carouselImages[index],
          title: text.t,
          subtitle: text.s
        }));
      }

      let carouselData = getCarouselData();

      let currentActiveIndex = 2; // Desktop: Start with middle tile active (index 2 out of 0-4)

      const tiles = document.querySelectorAll('.carousel-tile');
      const dotsContainer = document.querySelector('.carousel-dots');
      const carouselContainer = document.querySelector('.carousel-container');
      const isMobile = window.innerWidth <= 1024;

      // Initialize tiles with images and captions
      function initTiles() {
        tiles.forEach((tile, index) => {
          const dataIndex = index % carouselData.length;
          const data = carouselData[dataIndex];

          // Set background image
          tile.style.backgroundImage = `url('${data.src}')`;

          // Add caption
          const caption = document.createElement('div');
          caption.className = 'carousel-tile-caption';
          caption.innerHTML = `
            <div class="carousel-tile-title">${data.title}</div>
            <div class="carousel-tile-subtitle">${data.subtitle}</div>
          `;
          tile.appendChild(caption);

          // Store data index
          tile.dataset.dataIndex = dataIndex;

          // Click handler
          tile.addEventListener('click', () => {
            if (!tile.classList.contains('active')) {
              if (isMobile) {
                // Mobile: Scroll tile to center
                tile.scrollIntoView({
                  behavior: 'smooth',
                  block: 'nearest',
                  inline: 'center'
                });
              } else {
                // Desktop: Use setActiveTile
                setActiveTile(index);
              }
            }
          });
        });
      }

      // Initialize dots
      function initDots() {
        dotsContainer.innerHTML = carouselData.map((_, index) =>
          `<button class="carousel-dot ${index === 0 ? 'active' : ''}" data-index="${index}"></button>`
        ).join('');

        dotsContainer.querySelectorAll('.carousel-dot').forEach(dot => {
          dot.addEventListener('click', () => {
            goToDataIndex(parseInt(dot.dataset.index));
          });
        });
      }

      // Update carousel captions when language changes
      function updateCarouselLanguage() {
        carouselData = getCarouselData();
        tiles.forEach((tile, index) => {
          const dataIndex = parseInt(tile.dataset.dataIndex);
          if (dataIndex >= 0 && dataIndex < carouselData.length) {
            const data = carouselData[dataIndex];
            const caption = tile.querySelector('.carousel-tile-caption');
            if (caption) {
              caption.innerHTML = `
                <div class="carousel-tile-title">${data.title}</div>
                <div class="carousel-tile-subtitle">${data.subtitle}</div>
              `;
            }
          }
        });
      }

      // Expose update function globally
      window.updateCarouselLanguage = updateCarouselLanguage;

      // Set active tile by tile position (0-3)
      function setActiveTile(tileIndex) {
        // Remove active from all tiles
        tiles.forEach(tile => tile.classList.remove('active'));

        // Add active to selected tile
        tiles[tileIndex].classList.add('active');

        // Update current active index
        currentActiveIndex = tileIndex;

        // Update dots based on data index
        updateDots();
      }

      // Go to specific data index (from dots)
      function goToDataIndex(dataIndex) {
        // Find which tile currently shows this data
        let targetTileIndex = -1;
        tiles.forEach((tile, index) => {
          if (parseInt(tile.dataset.dataIndex) === dataIndex) {
            targetTileIndex = index;
          }
        });

        if (targetTileIndex !== -1) {
          if (isMobile) {
            // Mobile: Scroll tile to center
            tiles[targetTileIndex].scrollIntoView({
              behavior: 'smooth',
              block: 'nearest',
              inline: 'center'
            });
          } else {
            // Desktop: Use setActiveTile
            if (targetTileIndex !== currentActiveIndex) {
              setActiveTile(targetTileIndex);
            }
          }
        }
      }

      // Update dots based on active tile's data index
      function updateDots() {
        if (isMobile) {
          // Mobile: Find which tile is currently centered
          const containerRect = carouselContainer.getBoundingClientRect();
          const centerX = containerRect.left + containerRect.width / 2;

          let closestTile = null;
          let closestDistance = Infinity;

          tiles.forEach(tile => {
            // Skip if tile doesn't have a data-index (padding tiles don't have this)
            if (!tile.dataset.dataIndex) return;

            const tileRect = tile.getBoundingClientRect();
            const tileCenterX = tileRect.left + tileRect.width / 2;
            const distance = Math.abs(tileCenterX - centerX);

            if (distance < closestDistance) {
              closestDistance = distance;
              closestTile = tile;
            }
          });

          if (!closestTile) return; // Safety check

          // Update active class on tiles
          tiles.forEach(tile => {
            tile.classList.toggle('active', tile === closestTile);
          });

          // Update dots - remove all active first, then add to correct one
          const activeDataIndex = parseInt(closestTile.dataset.dataIndex);
          const allDots = document.querySelectorAll('.carousel-dot');
          allDots.forEach(dot => dot.classList.remove('active'));
          if (allDots[activeDataIndex]) {
            allDots[activeDataIndex].classList.add('active');
          }
        } else {
          // Desktop: Use currentActiveIndex
          const activeDataIndex = parseInt(tiles[currentActiveIndex].dataset.dataIndex);
          document.querySelectorAll('.carousel-dot').forEach((dot, index) => {
            dot.classList.toggle('active', index === activeDataIndex);
          });
        }
      }

      // Navigate next
      function nextSlide() {
        // Rotate tiles: move last tile's data to first, shift all data right
        const lastTileData = tiles[4].dataset.dataIndex;

        // Shift data from right to left
        for (let i = 4; i > 0; i--) {
          tiles[i].dataset.dataIndex = tiles[i - 1].dataset.dataIndex;
          tiles[i].style.backgroundImage = tiles[i - 1].style.backgroundImage;

          const caption = tiles[i].querySelector('.carousel-tile-caption');
          const prevCaption = tiles[i - 1].querySelector('.carousel-tile-caption');
          if (caption && prevCaption) {
            caption.innerHTML = prevCaption.innerHTML;
          }
        }

        // Set first tile with next data in sequence
        const newDataIndex = (parseInt(lastTileData) + 1) % carouselData.length;
        const newData = carouselData[newDataIndex];
        tiles[0].dataset.dataIndex = newDataIndex;
        tiles[0].style.backgroundImage = `url('${newData.src}')`;

        const firstCaption = tiles[0].querySelector('.carousel-tile-caption');
        if (firstCaption) {
          firstCaption.innerHTML = `
            <div class="carousel-tile-title">${newData.title}</div>
            <div class="carousel-tile-subtitle">${newData.subtitle}</div>
          `;
        }

        // Keep active tile at same position (visual stays in center)
        updateDots();
      }

      // Navigate previous
      function prevSlide() {
        // Rotate tiles: move first tile's data to last, shift all data left
        const firstTileData = tiles[0].dataset.dataIndex;

        // Shift data from left to right
        for (let i = 0; i < 4; i++) {
          tiles[i].dataset.dataIndex = tiles[i + 1].dataset.dataIndex;
          tiles[i].style.backgroundImage = tiles[i + 1].style.backgroundImage;

          const caption = tiles[i].querySelector('.carousel-tile-caption');
          const nextCaption = tiles[i + 1].querySelector('.carousel-tile-caption');
          if (caption && nextCaption) {
            caption.innerHTML = nextCaption.innerHTML;
          }
        }

        // Set last tile with previous data in sequence
        const newDataIndex = (parseInt(firstTileData) - 1 + carouselData.length) % carouselData.length;
        const newData = carouselData[newDataIndex];
        tiles[4].dataset.dataIndex = newDataIndex;
        tiles[4].style.backgroundImage = `url('${newData.src}')`;

        const lastCaption = tiles[4].querySelector('.carousel-tile-caption');
        if (lastCaption) {
          lastCaption.innerHTML = `
            <div class="carousel-tile-title">${newData.title}</div>
            <div class="carousel-tile-subtitle">${newData.subtitle}</div>
          `;
        }

        // Keep active tile at same position
        updateDots();
      }

      // Desktop only: Keyboard navigation
      if (!isMobile) {
        document.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowLeft') prevSlide();
          if (e.key === 'ArrowRight') nextSlide();
        });
      }

      // Mobile: Simple horizontal scroll with auto-centering
      if (isMobile && carouselContainer) {
        let scrollTimeout;

        // Set initial scroll position immediately (before carousel is visible)
        // This prevents the jump when user scrolls to the gallery
        setTimeout(() => {
          if (tiles[2]) {
            const middleTile = tiles[2];
            const containerWidth = carouselContainer.offsetWidth;
            const tileWidth = 304;
            const centerOffset = (containerWidth / 2) - (tileWidth / 2);

            // Set scroll position without animation to center the middle tile
            const middleTileOffset = middleTile.offsetLeft;
            carouselContainer.scrollLeft = middleTileOffset - centerOffset;

            // Update dots after initial positioning
            setTimeout(() => updateDots(), 50);
          }
        }, 0);

        // Update dots when scrolling - use multiple timeouts to catch the snap
        let scrollTimeout1, scrollTimeout2;

        carouselContainer.addEventListener('scroll', () => {
          // Quick update
          clearTimeout(scrollTimeout1);
          scrollTimeout1 = setTimeout(() => {
            updateDots();
          }, 0);

          // Delayed update to catch snap completion
          clearTimeout(scrollTimeout2);
          scrollTimeout2 = setTimeout(() => {
            updateDots();
          }, 300);
        }, { passive: true });

        // Also use scrollend if available (modern browsers)
        if ('onscrollend' in window) {
          carouselContainer.addEventListener('scrollend', () => {
            updateDots();
          }, { passive: true });
        }
      }

      // Initialize
      initTiles();
      initDots();
      updateDots();
    }

    </script>

  <!-- Privacy Policy Modal -->
  <div id="privacyModal" class="legal-modal">
    <div class="legal-modal-content">
      <button class="legal-modal-close" aria-label="Close">&times;</button>
      <div class="legal-modal-body">
        <h1 class="legal-modal-title" data-i18n="privacy-title">Polityka Prywatności</h1>
        <div class="legal-modal-text" id="privacyContent">
          <!-- Content will be loaded by JavaScript based on language -->
        </div>
      </div>
    </div>
  </div>

  <!-- Terms of Service Modal -->
  <div id="termsModal" class="legal-modal">
    <div class="legal-modal-content">
      <button class="legal-modal-close" aria-label="Close">&times;</button>
      <div class="legal-modal-body">
        <h1 class="legal-modal-title" data-i18n="terms-title">Regulamin</h1>
        <div class="legal-modal-text" id="termsContent">
          <!-- Content will be loaded by JavaScript based on language -->
        </div>
      </div>
    </div>
  </div>


  <script>
    // Legal Modal Content Data
    const legalContent = {
      privacy: {
        pl: `
          <h2>1. Informacje ogólne</h2>
          <p>Niniejsza Polityka Prywatności określa zasady przetwarzania i ochrony danych osobowych przekazanych przez Użytkowników w związku z korzystaniem z usług świadczonych drogą elektroniczną za pośrednictwem serwisu internetowego działającego pod adresem greensun.pl (dalej: „Serwis").</p>
          <p>Administratorem danych osobowych zbieranych za pośrednictwem Serwisu jest GreenSun z siedzibą we Francji (dalej: „Administrator" lub „GreenSun").</p>

          <h2>2. Dane kontaktowe Administratora</h2>
          <div class="legal-contact-info">
            <p><strong>GreenSun</strong></p>
            <p>E-mail: contact@green-sun.net</p>
            <p>Telefon: +33 749 78 48 56</p>
          </div>

          <h2>3. Rodzaje przetwarzanych danych</h2>
          <p>Administrator może przetwarzać następujące kategorie danych osobowych:</p>
          <ul>
            <li><strong>Dane identyfikacyjne:</strong> imię, nazwisko</li>
            <li><strong>Dane kontaktowe:</strong> adres e-mail, numer telefonu</li>
            <li><strong>Dane firmy:</strong> nazwa firmy, stanowisko</li>
            <li><strong>Dane techniczne:</strong> adres IP, rodzaj przeglądarki, system operacyjny</li>
            <li><strong>Dane o aktywności:</strong> informacje o korzystaniu z Serwisu</li>
          </ul>

          <h2>4. Cele i podstawy prawne przetwarzania danych</h2>

          <h3>4.1 Obsługa zapytań i kontakt</h3>
          <p><strong>Cel:</strong> Udzielanie odpowiedzi na zapytania przesłane przez formularz kontaktowy lub e-mail</p>
          <p><strong>Podstawa prawna:</strong> Prawnie uzasadniony interes Administratora (RODO Art. 6 ust. 1 lit. f)</p>
          <p><strong>Czas przechowywania:</strong> Do 3 lat od ostatniej korespondencji</p>

          <h3>4.2 Marketing bezpośredni</h3>
          <p><strong>Cel:</strong> Prowadzenie działań marketingowych, w tym przesyłanie informacji handlowych</p>
          <p><strong>Podstawa prawna:</strong> Zgoda (RODO Art. 6 ust. 1 lit. a)</p>
          <p><strong>Czas przechowywania:</strong> Do momentu wycofania zgody</p>

          <h3>4.3 Analityka i statystyki</h3>
          <p><strong>Cel:</strong> Analiza ruchu na stronie internetowej i optymalizacja Serwisu</p>
          <p><strong>Podstawa prawna:</strong> Prawnie uzasadniony interes Administratora (RODO Art. 6 ust. 1 lit. f)</p>
          <p><strong>Czas przechowywania:</strong> Do 26 miesięcy</p>

          <h2>5. Udostępnianie danych osobowych</h2>
          <p>Administrator może udostępniać dane osobowe następującym kategoriom odbiorców:</p>
          <ul>
            <li><strong>Podmioty świadczące usługi IT:</strong> dostawcy systemów informatycznych, hosting</li>
            <li><strong>Podmioty świadczące usługi marketingowe:</strong> agencje reklamowe, platformy analityczne</li>
            <li><strong>Podmioty świadczące usługi prawne i księgowe:</strong> w zakresie niezbędnym do realizacji usług</li>
            <li><strong>Organy państwowe:</strong> w przypadkach przewidzianych prawem</li>
          </ul>
          <p>Administrator nie przekazuje danych osobowych do państw trzecich lub organizacji międzynarodowych, z wyjątkiem wykorzystywania narzędzi analitycznych zgodnie z odpowiednimi zabezpieczeniami.</p>

          <h2>6. Prawa osób, których dane dotyczą</h2>
          <p>Osoby, których dane są przetwarzane, mają prawo do:</p>
          <ul>
            <li><strong>Dostępu do danych:</strong> uzyskania informacji o przetwarzanych danych</li>
            <li><strong>Sprostowania danych:</strong> poprawienia nieprawidłowych lub niekompletnych danych</li>
            <li><strong>Usunięcia danych:</strong> żądania usunięcia danych w określonych przypadkach</li>
            <li><strong>Ograniczenia przetwarzania:</strong> ograniczenia przetwarzania w określonych sytuacjach</li>
            <li><strong>Przenoszenia danych:</strong> otrzymania danych w ustrukturyzowanym formacie</li>
            <li><strong>Sprzeciwu:</strong> wniesienia sprzeciwu wobec przetwarzania danych</li>
            <li><strong>Cofnięcia zgody:</strong> w przypadku przetwarzania na podstawie zgody</li>
          </ul>
          <p>W celu realizacji powyższych praw należy skontaktować się z Administratorem za pośrednictwem adresu e-mail: contact@green-sun.net</p>

          <h2>7. Cookies i technologie śledzące</h2>
          <p>Serwis wykorzystuje pliki cookies i podobne technologie w następujących celach:</p>
          <ul>
            <li><strong>Cookies niezbędne:</strong> zapewnienie prawidłowego funkcjonowania Serwisu</li>
            <li><strong>Cookies analityczne:</strong> zbieranie statystyk o korzystaniu z Serwisu</li>
            <li><strong>Cookies marketingowe:</strong> personalizacja reklam i treści</li>
          </ul>
          <p>Użytkownik może zarządzać ustawieniami cookies za pośrednictwem przeglądarki internetowej.</p>

          <h2>8. Bezpieczeństwo danych</h2>
          <p>Administrator stosuje odpowiednie środki techniczne i organizacyjne w celu zapewnienia bezpieczeństwa przetwarzanych danych osobowych, w szczególności:</p>
          <ul>
            <li>Szyfrowanie danych podczas transmisji (protokół HTTPS)</li>
            <li>Regularne kopie zapasowe danych</li>
            <li>Ograniczenie dostępu do danych tylko dla uprawnionych osób</li>
            <li>Regularne aktualizacje systemów informatycznych</li>
            <li>Monitoring bezpieczeństwa systemów</li>
          </ul>

          <h2>9. Zmiany Polityki Prywatności</h2>
          <p>Administrator zastrzega sobie prawo do wprowadzania zmian w niniejszej Polityce Prywatności. O wszelkich zmianach Użytkownicy będą informowani poprzez publikację zaktualizowanej wersji na stronie internetowej.</p>
          <p><strong>Data ostatniej aktualizacji:</strong> 23 listopada 2024</p>

          <h2>10. Kontakt w sprawie danych osobowych</h2>
          <p>W przypadku pytań dotyczących przetwarzania danych osobowych lub realizacji przysługujących praw, prosimy o kontakt:</p>
          <div class="legal-contact-info">
            <p><strong>E-mail:</strong> contact@green-sun.net</p>
            <p><strong>Telefon:</strong> +33 749 78 48 56</p>
          </div>
        `,
        en: `
          <h2>1. General Information</h2>
          <p>This Privacy Policy defines the rules for processing and protecting personal data provided by Users in connection with the use of services provided electronically through the website operating at greensun.pl (hereinafter: "Website").</p>
          <p>The controller of personal data collected through the Website is GreenSun based in France (hereinafter: "Controller" or "GreenSun").</p>

          <h2>2. Controller Contact Details</h2>
          <div class="legal-contact-info">
            <p><strong>GreenSun</strong></p>
            <p>E-mail: contact@green-sun.net</p>
            <p>Phone: +33 749 78 48 56</p>
          </div>

          <h2>3. Types of Processed Data</h2>
          <p>The Controller may process the following categories of personal data:</p>
          <ul>
            <li><strong>Identification data:</strong> first name, last name</li>
            <li><strong>Contact data:</strong> email address, phone number</li>
            <li><strong>Company data:</strong> company name, position</li>
            <li><strong>Technical data:</strong> IP address, browser type, operating system</li>
            <li><strong>Activity data:</strong> information about the use of the Website</li>
          </ul>

          <h2>4. Purposes and Legal Bases for Data Processing</h2>

          <h3>4.1 Handling Inquiries and Contact</h3>
          <p><strong>Purpose:</strong> Providing responses to inquiries sent via contact form or email</p>
          <p><strong>Legal basis:</strong> Legitimate interest of the Controller (GDPR Art. 6(1)(f))</p>
          <p><strong>Retention period:</strong> Up to 3 years from the last correspondence</p>

          <h3>4.2 Direct Marketing</h3>
          <p><strong>Purpose:</strong> Conducting marketing activities, including sending commercial information</p>
          <p><strong>Legal basis:</strong> Consent (GDPR Art. 6(1)(a))</p>
          <p><strong>Retention period:</strong> Until consent is withdrawn</p>

          <h3>4.3 Analytics and Statistics</h3>
          <p><strong>Purpose:</strong> Analyzing website traffic and optimizing the Website</p>
          <p><strong>Legal basis:</strong> Legitimate interest of the Controller (GDPR Art. 6(1)(f))</p>
          <p><strong>Retention period:</strong> Up to 26 months</p>

          <h2>5. Sharing Personal Data</h2>
          <p>The Controller may share personal data with the following categories of recipients:</p>
          <ul>
            <li><strong>IT service providers:</strong> IT system providers, hosting</li>
            <li><strong>Marketing service providers:</strong> advertising agencies, analytical platforms</li>
            <li><strong>Legal and accounting service providers:</strong> to the extent necessary for service delivery</li>
            <li><strong>State authorities:</strong> in cases provided by law</li>
          </ul>
          <p>The Controller does not transfer personal data to third countries or international organizations, except for the use of analytical tools in accordance with appropriate safeguards.</p>

          <h2>6. Rights of Data Subjects</h2>
          <p>Data subjects have the right to:</p>
          <ul>
            <li><strong>Access to data:</strong> obtaining information about processed data</li>
            <li><strong>Rectification of data:</strong> correcting inaccurate or incomplete data</li>
            <li><strong>Erasure of data:</strong> requesting deletion of data in certain cases</li>
            <li><strong>Restriction of processing:</strong> limiting processing in certain situations</li>
            <li><strong>Data portability:</strong> receiving data in a structured format</li>
            <li><strong>Object:</strong> objecting to data processing</li>
            <li><strong>Withdraw consent:</strong> in case of processing based on consent</li>
          </ul>
          <p>To exercise these rights, please contact the Controller at: contact@green-sun.net</p>

          <h2>7. Cookies and Tracking Technologies</h2>
          <p>The Website uses cookies and similar technologies for the following purposes:</p>
          <ul>
            <li><strong>Necessary cookies:</strong> ensuring proper functioning of the Website</li>
            <li><strong>Analytical cookies:</strong> collecting statistics on the use of the Website</li>
            <li><strong>Marketing cookies:</strong> personalization of ads and content</li>
          </ul>
          <p>Users can manage cookie settings through their web browser.</p>

          <h2>8. Data Security</h2>
          <p>The Controller implements appropriate technical and organizational measures to ensure the security of processed personal data, in particular:</p>
          <ul>
            <li>Data encryption during transmission (HTTPS protocol)</li>
            <li>Regular data backups</li>
            <li>Limiting data access to authorized persons only</li>
            <li>Regular updates of IT systems</li>
            <li>System security monitoring</li>
          </ul>

          <h2>9. Changes to Privacy Policy</h2>
          <p>The Controller reserves the right to make changes to this Privacy Policy. Users will be informed of any changes through the publication of an updated version on the website.</p>
          <p><strong>Last update date:</strong> November 23, 2024</p>

          <h2>10. Contact Regarding Personal Data</h2>
          <p>For questions regarding the processing of personal data or exercising your rights, please contact:</p>
          <div class="legal-contact-info">
            <p><strong>E-mail:</strong> contact@green-sun.net</p>
            <p><strong>Phone:</strong> +33 749 78 48 56</p>
          </div>
        `,
        fr: `
          <h2>1. Informations Générales</h2>
          <p>Cette Politique de Confidentialité définit les règles de traitement et de protection des données personnelles fournies par les Utilisateurs dans le cadre de l'utilisation des services fournis électroniquement via le site web fonctionnant à l'adresse greensun.pl (ci-après : le "Site").</p>
          <p>Le responsable du traitement des données personnelles collectées via le Site est GreenSun basé en France (ci-après : le "Responsable" ou "GreenSun").</p>

          <h2>2. Coordonnées du Responsable</h2>
          <div class="legal-contact-info">
            <p><strong>GreenSun</strong></p>
            <p>E-mail : contact@green-sun.net</p>
            <p>Téléphone : +33 749 78 48 56</p>
          </div>

          <h2>3. Types de Données Traitées</h2>
          <p>Le Responsable peut traiter les catégories suivantes de données personnelles :</p>
          <ul>
            <li><strong>Données d'identification :</strong> prénom, nom</li>
            <li><strong>Données de contact :</strong> adresse e-mail, numéro de téléphone</li>
            <li><strong>Données d'entreprise :</strong> nom de l'entreprise, poste</li>
            <li><strong>Données techniques :</strong> adresse IP, type de navigateur, système d'exploitation</li>
            <li><strong>Données d'activité :</strong> informations sur l'utilisation du Site</li>
          </ul>

          <h2>4. Finalités et Bases Juridiques du Traitement</h2>

          <h3>4.1 Gestion des Demandes et Contact</h3>
          <p><strong>Finalité :</strong> Répondre aux demandes envoyées via le formulaire de contact ou par e-mail</p>
          <p><strong>Base juridique :</strong> Intérêt légitime du Responsable (RGPD Art. 6(1)(f))</p>
          <p><strong>Durée de conservation :</strong> Jusqu'à 3 ans après la dernière correspondance</p>

          <h3>4.2 Marketing Direct</h3>
          <p><strong>Finalité :</strong> Réalisation d'activités marketing, y compris l'envoi d'informations commerciales</p>
          <p><strong>Base juridique :</strong> Consentement (RGPD Art. 6(1)(a))</p>
          <p><strong>Durée de conservation :</strong> Jusqu'au retrait du consentement</p>

          <h3>4.3 Analytique et Statistiques</h3>
          <p><strong>Finalité :</strong> Analyse du trafic sur le site web et optimisation du Site</p>
          <p><strong>Base juridique :</strong> Intérêt légitime du Responsable (RGPD Art. 6(1)(f))</p>
          <p><strong>Durée de conservation :</strong> Jusqu'à 26 mois</p>

          <h2>5. Partage des Données Personnelles</h2>
          <p>Le Responsable peut partager des données personnelles avec les catégories de destinataires suivantes :</p>
          <ul>
            <li><strong>Prestataires de services IT :</strong> fournisseurs de systèmes informatiques, hébergement</li>
            <li><strong>Prestataires de services marketing :</strong> agences publicitaires, plateformes analytiques</li>
            <li><strong>Prestataires de services juridiques et comptables :</strong> dans la mesure nécessaire à la fourniture de services</li>
            <li><strong>Autorités publiques :</strong> dans les cas prévus par la loi</li>
          </ul>
          <p>Le Responsable ne transfère pas de données personnelles vers des pays tiers ou des organisations internationales, à l'exception de l'utilisation d'outils analytiques conformément aux garanties appropriées.</p>

          <h2>6. Droits des Personnes Concernées</h2>
          <p>Les personnes concernées ont le droit de :</p>
          <ul>
            <li><strong>Accès aux données :</strong> obtenir des informations sur les données traitées</li>
            <li><strong>Rectification des données :</strong> corriger les données inexactes ou incomplètes</li>
            <li><strong>Effacement des données :</strong> demander la suppression des données dans certains cas</li>
            <li><strong>Limitation du traitement :</strong> limiter le traitement dans certaines situations</li>
            <li><strong>Portabilité des données :</strong> recevoir les données dans un format structuré</li>
            <li><strong>Opposition :</strong> s'opposer au traitement des données</li>
            <li><strong>Retrait du consentement :</strong> en cas de traitement basé sur le consentement</li>
          </ul>
          <p>Pour exercer ces droits, veuillez contacter le Responsable à : contact@green-sun.net</p>

          <h2>7. Cookies et Technologies de Suivi</h2>
          <p>Le Site utilise des cookies et des technologies similaires aux fins suivantes :</p>
          <ul>
            <li><strong>Cookies nécessaires :</strong> assurer le bon fonctionnement du Site</li>
            <li><strong>Cookies analytiques :</strong> collecter des statistiques sur l'utilisation du Site</li>
            <li><strong>Cookies marketing :</strong> personnalisation des publicités et du contenu</li>
          </ul>
          <p>Les utilisateurs peuvent gérer les paramètres des cookies via leur navigateur web.</p>

          <h2>8. Sécurité des Données</h2>
          <p>Le Responsable met en œuvre des mesures techniques et organisationnelles appropriées pour assurer la sécurité des données personnelles traitées, notamment :</p>
          <ul>
            <li>Chiffrement des données lors de la transmission (protocole HTTPS)</li>
            <li>Sauvegardes régulières des données</li>
            <li>Limitation de l'accès aux données aux personnes autorisées uniquement</li>
            <li>Mises à jour régulières des systèmes informatiques</li>
            <li>Surveillance de la sécurité des systèmes</li>
          </ul>

          <h2>9. Modifications de la Politique de Confidentialité</h2>
          <p>Le Responsable se réserve le droit d'apporter des modifications à cette Politique de Confidentialité. Les utilisateurs seront informés de tout changement par la publication d'une version mise à jour sur le site web.</p>
          <p><strong>Date de dernière mise à jour :</strong> 23 novembre 2024</p>

          <h2>10. Contact Concernant les Données Personnelles</h2>
          <p>Pour toute question concernant le traitement des données personnelles ou l'exercice de vos droits, veuillez contacter :</p>
          <div class="legal-contact-info">
            <p><strong>E-mail :</strong> contact@green-sun.net</p>
            <p><strong>Téléphone :</strong> +33 749 78 48 56</p>
          </div>
        `
      },
      terms: {
        pl: `
          <h2>1. Postanowienia ogólne</h2>
          <p>Niniejszy Regulamin określa zasady korzystania z serwisu internetowego działającego pod adresem greensun.pl (dalej: „Serwis") oraz świadczenia usług drogą elektroniczną przez GreenSun.</p>
          <p>Korzystanie z Serwisu jest równoznaczne z akceptacją niniejszego Regulaminu.</p>

          <h2>2. Definicje</h2>
          <ul>
            <li><strong>Serwis</strong> – strona internetowa działająca pod adresem greensun.pl wraz z wszystkimi podstronami</li>
            <li><strong>Usługodawca</strong> – GreenSun z siedzibą we Francji</li>
            <li><strong>Użytkownik</strong> – każda osoba fizyczna, prawna lub jednostka organizacyjna korzystająca z Serwisu</li>
            <li><strong>Usługa elektroniczna</strong> – usługa świadczona drogą elektroniczną przez Usługodawcę na rzecz Użytkownika za pośrednictwem Serwisu</li>
          </ul>

          <h2>3. Rodzaje usług świadczonych elektronicznie</h2>
          <p>Usługodawca świadczy następujące usługi elektroniczne:</p>
          <ul>
            <li>Udostępnianie treści informacyjnych o działalności GreenSun</li>
            <li>Umożliwienie kontaktu poprzez formularz kontaktowy</li>
            <li>Prezentacja portfolio realizacji fotowoltaicznych</li>
            <li>Udostępnianie informacji o oferowanych usługach</li>
          </ul>

          <h2>4. Warunki korzystania z Serwisu</h2>

          <h3>4.1 Wymagania techniczne</h3>
          <p>Korzystanie z Serwisu wymaga:</p>
          <ul>
            <li>Urządzenia z dostępem do Internetu</li>
            <li>Przeglądarki internetowej obsługującej JavaScript i cookies</li>
            <li>Aktywnego połączenia internetowego</li>
            <li>Adresu e-mail (w przypadku korzystania z formularza kontaktowego)</li>
          </ul>

          <h3>4.2 Zasady korzystania</h3>
          <p>Użytkownik zobowiązuje się do:</p>
          <ul>
            <li>Korzystania z Serwisu w sposób zgodny z prawem i niniejszym Regulaminem</li>
            <li>Niepodejmowania działań mogących zakłócić funkcjonowanie Serwisu</li>
            <li>Niepublikowania treści niezgodnych z prawem lub dobrymi obyczajami</li>
            <li>Poszanowania praw autorskich i własności intelektualnej Usługodawcy</li>
          </ul>

          <h2>5. Formularz kontaktowy</h2>
          <p>Użytkownik może skontaktować się z Usługodawcą za pośrednictwem formularza kontaktowego dostępnego w Serwisie.</p>
          <p>Wysłanie wiadomości poprzez formularz wymaga podania:</p>
          <ul>
            <li>Imienia i nazwiska</li>
            <li>Adresu e-mail</li>
            <li>Treści wiadomości</li>
            <li>Wyrażenia zgody na przetwarzanie danych osobowych</li>
          </ul>
          <p>Usługodawca zobowiązuje się do udzielenia odpowiedzi na zapytania w terminie do 3 dni roboczych.</p>

          <h2>6. Prawa autorskie i własność intelektualna</h2>
          <p>Wszystkie treści zamieszczone w Serwisie, w tym teksty, grafiki, logotypy, zdjęcia, filmy, oraz struktura i układ strony, są chronione prawem autorskim i stanowią własność intelektualną GreenSun lub podmiotów trzecich, które udzieliły licencji na ich wykorzystanie.</p>
          <p>Zabronione jest kopiowanie, rozpowszechnianie lub wykorzystywanie w jakikolwiek sposób treści Serwisu bez uprzedniej pisemnej zgody Usługodawcy.</p>

          <h2>7. Odpowiedzialność</h2>

          <h3>7.1 Odpowiedzialność Usługodawcy</h3>
          <p>Usługodawca nie ponosi odpowiedzialności za:</p>
          <ul>
            <li>Szkody powstałe w wyniku korzystania lub niemożności korzystania z Serwisu</li>
            <li>Przerwy w dostępie do Serwisu wynikające z przyczyn technicznych</li>
            <li>Treści zamieszczone przez Użytkowników</li>
            <li>Działania osób trzecich naruszające funkcjonowanie Serwisu</li>
          </ul>

          <h3>7.2 Odpowiedzialność Użytkownika</h3>
          <p>Użytkownik ponosi pełną odpowiedzialność za:</p>
          <ul>
            <li>Naruszenie postanowień niniejszego Regulaminu</li>
            <li>Naruszenie praw osób trzecich w wyniku korzystania z Serwisu</li>
            <li>Podanie nieprawdziwych lub niepełnych danych</li>
          </ul>

          <h2>8. Ochrona danych osobowych</h2>
          <p>Zasady przetwarzania danych osobowych określa Polityka Prywatności dostępna w Serwisie.</p>
          <p>Korzystając z formularza kontaktowego, Użytkownik wyraża zgodę na przetwarzanie podanych danych osobowych w celu udzielenia odpowiedzi na zapytanie.</p>

          <h2>9. Pliki cookies</h2>
          <p>Serwis wykorzystuje pliki cookies w celach:</p>
          <ul>
            <li>Zapewnienia prawidłowego funkcjonowania Serwisu</li>
            <li>Zbierania statystyk i analityki</li>
            <li>Personalizacji treści</li>
          </ul>
          <p>Użytkownik może w każdej chwili zmienić ustawienia cookies w przeglądarce internetowej.</p>

          <h2>10. Postanowienia końcowe</h2>
          <p>Usługodawca zastrzega sobie prawo do wprowadzania zmian w Regulaminie. O zmianach Użytkownicy zostaną poinformowani poprzez publikację nowej wersji Regulaminu w Serwisie.</p>
          <p>Zmiany wchodzą w życie w terminie wskazanym przez Usługodawcę, nie krótszym niż 7 dni od daty publikacji.</p>
          <p>W sprawach nieuregulowanych niniejszym Regulaminem zastosowanie mają przepisy prawa francuskiego.</p>
          <p><strong>Data wejścia w życie:</strong> 23 listopada 2024</p>

          <h2>11. Kontakt</h2>
          <div class="legal-contact-info">
            <p><strong>GreenSun</strong></p>
            <p>E-mail: contact@green-sun.net</p>
            <p>Telefon: +33 749 78 48 56</p>
          </div>
        `,
        en: `
          <h2>1. General Provisions</h2>
          <p>These Terms of Service define the rules for using the website operating at greensun.pl (hereinafter: the "Website") and the provision of electronic services by GreenSun.</p>
          <p>Using the Website is equivalent to accepting these Terms of Service.</p>

          <h2>2. Definitions</h2>
          <ul>
            <li><strong>Website</strong> – the website operating at greensun.pl along with all subpages</li>
            <li><strong>Service Provider</strong> – GreenSun based in France</li>
            <li><strong>User</strong> – any natural person, legal entity, or organizational unit using the Website</li>
            <li><strong>Electronic Service</strong> – a service provided electronically by the Service Provider to the User through the Website</li>
          </ul>

          <h2>3. Types of Electronic Services Provided</h2>
          <p>The Service Provider provides the following electronic services:</p>
          <ul>
            <li>Providing informational content about GreenSun's activities</li>
            <li>Enabling contact through a contact form</li>
            <li>Presenting a portfolio of photovoltaic projects</li>
            <li>Providing information about offered services</li>
          </ul>

          <h2>4. Terms of Use of the Website</h2>

          <h3>4.1 Technical Requirements</h3>
          <p>Using the Website requires:</p>
          <ul>
            <li>A device with Internet access</li>
            <li>A web browser supporting JavaScript and cookies</li>
            <li>An active Internet connection</li>
            <li>An email address (when using the contact form)</li>
          </ul>

          <h3>4.2 Rules of Use</h3>
          <p>The User agrees to:</p>
          <ul>
            <li>Use the Website in accordance with the law and these Terms of Service</li>
            <li>Not undertake actions that could disrupt the functioning of the Website</li>
            <li>Not publish content contrary to law or good morals</li>
            <li>Respect the copyright and intellectual property of the Service Provider</li>
          </ul>

          <h2>5. Contact Form</h2>
          <p>The User can contact the Service Provider through the contact form available on the Website.</p>
          <p>Sending a message through the form requires providing:</p>
          <ul>
            <li>First and last name</li>
            <li>Email address</li>
            <li>Message content</li>
            <li>Consent to the processing of personal data</li>
          </ul>
          <p>The Service Provider undertakes to respond to inquiries within 3 business days.</p>

          <h2>6. Copyright and Intellectual Property</h2>
          <p>All content posted on the Website, including texts, graphics, logos, photos, videos, and the structure and layout of the page, are protected by copyright and constitute the intellectual property of GreenSun or third parties that have granted a license for their use.</p>
          <p>It is forbidden to copy, distribute, or use in any way the content of the Website without the prior written consent of the Service Provider.</p>

          <h2>7. Liability</h2>

          <h3>7.1 Service Provider's Liability</h3>
          <p>The Service Provider is not liable for:</p>
          <ul>
            <li>Damages resulting from the use or inability to use the Website</li>
            <li>Interruptions in access to the Website resulting from technical reasons</li>
            <li>Content posted by Users</li>
            <li>Actions of third parties violating the functioning of the Website</li>
          </ul>

          <h3>7.2 User's Liability</h3>
          <p>The User bears full responsibility for:</p>
          <ul>
            <li>Violation of the provisions of these Terms of Service</li>
            <li>Violation of the rights of third parties as a result of using the Website</li>
            <li>Providing false or incomplete data</li>
          </ul>

          <h2>8. Personal Data Protection</h2>
          <p>The rules for processing personal data are defined in the Privacy Policy available on the Website.</p>
          <p>By using the contact form, the User consents to the processing of provided personal data for the purpose of responding to the inquiry.</p>

          <h2>9. Cookies</h2>
          <p>The Website uses cookies for the purposes of:</p>
          <ul>
            <li>Ensuring proper functioning of the Website</li>
            <li>Collecting statistics and analytics</li>
            <li>Personalizing content</li>
          </ul>
          <p>The User can change cookie settings in the web browser at any time.</p>

          <h2>10. Final Provisions</h2>
          <p>The Service Provider reserves the right to make changes to the Terms of Service. Users will be informed of changes through the publication of a new version of the Terms of Service on the Website.</p>
          <p>Changes take effect on the date specified by the Service Provider, not less than 7 days from the date of publication.</p>
          <p>In matters not regulated by these Terms of Service, the provisions of French law shall apply.</p>
          <p><strong>Effective date:</strong> November 23, 2024</p>

          <h2>11. Contact</h2>
          <div class="legal-contact-info">
            <p><strong>GreenSun</strong></p>
            <p>E-mail: contact@green-sun.net</p>
            <p>Phone: +33 749 78 48 56</p>
          </div>
        `,
        fr: `
          <h2>1. Dispositions Générales</h2>
          <p>Ces Conditions d'Utilisation définissent les règles d'utilisation du site web fonctionnant à l'adresse greensun.pl (ci-après : le "Site") et la fourniture de services électroniques par GreenSun.</p>
          <p>L'utilisation du Site équivaut à l'acceptation de ces Conditions d'Utilisation.</p>

          <h2>2. Définitions</h2>
          <ul>
            <li><strong>Site</strong> – le site web fonctionnant à l'adresse greensun.pl avec toutes les sous-pages</li>
            <li><strong>Prestataire de Services</strong> – GreenSun basé en France</li>
            <li><strong>Utilisateur</strong> – toute personne physique, entité juridique ou unité organisationnelle utilisant le Site</li>
            <li><strong>Service Électronique</strong> – un service fourni électroniquement par le Prestataire de Services à l'Utilisateur via le Site</li>
          </ul>

          <h2>3. Types de Services Électroniques Fournis</h2>
          <p>Le Prestataire de Services fournit les services électroniques suivants :</p>
          <ul>
            <li>Mise à disposition de contenu informatif sur les activités de GreenSun</li>
            <li>Possibilité de contact via un formulaire de contact</li>
            <li>Présentation d'un portfolio de projets photovoltaïques</li>
            <li>Fourniture d'informations sur les services proposés</li>
          </ul>

          <h2>4. Conditions d'Utilisation du Site</h2>

          <h3>4.1 Exigences Techniques</h3>
          <p>L'utilisation du Site nécessite :</p>
          <ul>
            <li>Un appareil avec accès Internet</li>
            <li>Un navigateur web supportant JavaScript et les cookies</li>
            <li>Une connexion Internet active</li>
            <li>Une adresse e-mail (lors de l'utilisation du formulaire de contact)</li>
          </ul>

          <h3>4.2 Règles d'Utilisation</h3>
          <p>L'Utilisateur s'engage à :</p>
          <ul>
            <li>Utiliser le Site conformément à la loi et à ces Conditions d'Utilisation</li>
            <li>Ne pas entreprendre d'actions pouvant perturber le fonctionnement du Site</li>
            <li>Ne pas publier de contenu contraire à la loi ou aux bonnes mœurs</li>
            <li>Respecter le droit d'auteur et la propriété intellectuelle du Prestataire de Services</li>
          </ul>

          <h2>5. Formulaire de Contact</h2>
          <p>L'Utilisateur peut contacter le Prestataire de Services via le formulaire de contact disponible sur le Site.</p>
          <p>L'envoi d'un message via le formulaire nécessite de fournir :</p>
          <ul>
            <li>Prénom et nom</li>
            <li>Adresse e-mail</li>
            <li>Contenu du message</li>
            <li>Consentement au traitement des données personnelles</li>
          </ul>
          <p>Le Prestataire de Services s'engage à répondre aux demandes dans un délai de 3 jours ouvrables.</p>

          <h2>6. Droit d'Auteur et Propriété Intellectuelle</h2>
          <p>Tout le contenu publié sur le Site, y compris les textes, graphiques, logos, photos, vidéos, ainsi que la structure et la mise en page, sont protégés par le droit d'auteur et constituent la propriété intellectuelle de GreenSun ou de tiers qui ont accordé une licence pour leur utilisation.</p>
          <p>Il est interdit de copier, distribuer ou utiliser de quelque manière que ce soit le contenu du Site sans le consentement écrit préalable du Prestataire de Services.</p>

          <h2>7. Responsabilité</h2>

          <h3>7.1 Responsabilité du Prestataire de Services</h3>
          <p>Le Prestataire de Services n'est pas responsable de :</p>
          <ul>
            <li>Dommages résultant de l'utilisation ou de l'impossibilité d'utiliser le Site</li>
            <li>Interruptions d'accès au Site résultant de raisons techniques</li>
            <li>Contenu publié par les Utilisateurs</li>
            <li>Actions de tiers violant le fonctionnement du Site</li>
          </ul>

          <h3>7.2 Responsabilité de l'Utilisateur</h3>
          <p>L'Utilisateur assume l'entière responsabilité de :</p>
          <ul>
            <li>Violation des dispositions de ces Conditions d'Utilisation</li>
            <li>Violation des droits de tiers résultant de l'utilisation du Site</li>
            <li>Fourniture de données fausses ou incomplètes</li>
          </ul>

          <h2>8. Protection des Données Personnelles</h2>
          <p>Les règles de traitement des données personnelles sont définies dans la Politique de Confidentialité disponible sur le Site.</p>
          <p>En utilisant le formulaire de contact, l'Utilisateur consent au traitement des données personnelles fournies dans le but de répondre à la demande.</p>

          <h2>9. Cookies</h2>
          <p>Le Site utilise des cookies aux fins suivantes :</p>
          <ul>
            <li>Assurer le bon fonctionnement du Site</li>
            <li>Collecter des statistiques et des analyses</li>
            <li>Personnaliser le contenu</li>
          </ul>
          <p>L'Utilisateur peut modifier les paramètres des cookies dans le navigateur web à tout moment.</p>

          <h2>10. Dispositions Finales</h2>
          <p>Le Prestataire de Services se réserve le droit d'apporter des modifications aux Conditions d'Utilisation. Les utilisateurs seront informés des modifications par la publication d'une nouvelle version des Conditions d'Utilisation sur le Site.</p>
          <p>Les modifications entrent en vigueur à la date spécifiée par le Prestataire de Services, au plus tôt 7 jours après la date de publication.</p>
          <p>Pour les questions non réglementées par ces Conditions d'Utilisation, les dispositions du droit français s'appliquent.</p>
          <p><strong>Date d'entrée en vigueur :</strong> 23 novembre 2024</p>

          <h2>11. Contact</h2>
          <div class="legal-contact-info">
            <p><strong>GreenSun</strong></p>
            <p>E-mail : contact@green-sun.net</p>
            <p>Téléphone : +33 749 78 48 56</p>
          </div>
        `
      }
    };

    // Legal Modal Functions
    function openLegalModal(type) {
      const modal = document.getElementById(type + 'Modal');
      const content = document.getElementById(type + 'Content');
      const lang = currentLanguage || 'pl';

      // Load content
      if (legalContent[type] && legalContent[type][lang]) {
        content.innerHTML = legalContent[type][lang];
      }

      // Show modal with animation
      modal.classList.add('active');
      setTimeout(() => {
        modal.classList.add('show');
      }, 10);

      // Prevent body scroll
      document.body.style.overflow = 'hidden';
    }

    function closeLegalModal(modal) {
      modal.classList.remove('show');
      setTimeout(() => {
        modal.classList.remove('active');
        document.body.style.overflow = '';
      }, 300);
    }

    // Setup legal modal event listeners (using event delegation)
    function setupLegalModals() {
      // Use event delegation on document - works even after content updates
      document.addEventListener('click', function(e) {
        // Check if it's a close button (button element)
        const closeButton = e.target.closest('.legal-modal-close');
        if (closeButton) {
          const modal = closeButton.closest('.legal-modal');
          if (modal) closeLegalModal(modal);
          return;
        }

        // Check if clicking outside modal (on backdrop)
        if (e.target.classList.contains('legal-modal')) {
          closeLegalModal(e.target);
          return;
        }

        // Check if it's a link
        const link = e.target.closest('a');
        if (!link) return;

        // Check if it's a privacy or terms link
        if (link.getAttribute('href') === 'privacy.html' ||
            link.getAttribute('data-i18n') === 'footer-privacy' ||
            link.getAttribute('data-i18n') === 'cookie-learn') {
          e.preventDefault();
          openLegalModal('privacy');
          return;
        }

        if (link.getAttribute('href') === 'terms.html' ||
            link.getAttribute('data-i18n') === 'footer-terms') {
          e.preventDefault();
          openLegalModal('terms');
          return;
        }
      });

      // ESC key to close
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          document.querySelectorAll('.legal-modal.show').forEach(modal => {
            closeLegalModal(modal);
          });
        }
      });
    }

    // Call setup function on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function() {
      setupLegalModals();
    });
  </script>

</body>
</html>